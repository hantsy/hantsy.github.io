<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>
  Hantsy
  
  Bai
  
  
  | Building your own Maven archetype
  
</title>
<meta name="description" content="My personal website focusing on Java EE/Jakarta EE and Spring.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
  rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css"
  integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"
  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css"
  integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css"
  href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet"
  href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->
<link rel="shortcut icon" href="/assets/img/favicon.ico">
<link rel="stylesheet" href="/assets/css/main.css">

<link rel="canonical" href="/blog/2021/building-your-own-maven-archetype/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

<script src="/assets/js/theme.js"></script>
<!-- Load DarkMode JS -->
<script src="/assets/js/dark_mode.js"></script>



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-18SZ2W3GXD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'G-18SZ2W3GXD');
</script>




  
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  <link type="application/atom+xml" rel="alternate" href="/feed.xml" title="blank" />
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Building your own Maven archetype" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Github is easy to share codes with others, for example I created jakartaee9-starter-boilerplate as a project template for Jakarta EE developers. For those who are familiar with Github, it is easy to start their new projects by forking or cloning this project directly. But obviously for a general Jakarta EE application, you do not need the configuraitons of all application severs, eg. Glassfish/Payara, WildFly, OpenLiberty, Apache TomEE, etc. For most of Java developers esp. Maven users, a simple and clean Maven archetype is still the preferred option to generate the new project skeleton, and you can add the required configuration back later. I had created some maven archetype like toys myself in the past years, but I never made them public through the Maven Central repository. In this post, I will replay the steps of creating the Maven Archetype for Jakarta EE 9 and the followed steps of publishing it to the Maven Central repository and making it public to the world. A better formatted version is published on dev.to, https://dev.to/hantsy_26/building-your-own-maven-archetype-gm8 Generating the archetype project skeleton Maven archetype is the Maven specific templates used to generate a new project in the Maven build system. Maven itself provides an official archetype (maven-archetype-archetype) for you to build your own Maven archetype. The official archetype introduction page lists all official archetypes. Run the following command to generate the archetype project in an interactive mode. mvn archetype:generate When you hit down the Enter key, it will take some seconds to list all available archetypes. Every archetype is attached to a number. Type the number of maven-archetype-archetype , then it will ask you to fill groupId, archetypeId, package and version of your project. After all fields are filled as expected, it will generate the project in seconds. Alternatively, you can generate the project in a single command aka the batch mode. mvn archetype:generate -B \-DarchetypeGroupId=org.apache.maven.archetypes \-DarchetypeArtifactId=maven-archetype-archetype \-DarchetypeVersion=1.4 \-DgroupId=io.github.hantsy \-DartifactId=maven-archetype-jakartaee9 \-Dversion=1.0-SNAPSHOT Note here we use the -B parameter in the command line to skip the interactive questionnaire steps and run the command in batch mode. More info about Maven archetype and maven-archetype-plugin, please check Maven Archetype. Exploring the project structure Import the project into your IDEs, such as Apache NetBeans, IntelliJ IDEA, etc. You will see the following project file structure. ├── pom.xml└── src ├── main │ └── resources │ ├── archetype-resources │ │ ├── pom.xml │ │ └── src │ │ ├── main │ │ │ └── java │ │ │ └── App.java │ │ └── test │ │ └── java │ │ └── AppTest.java │ └── META-INF │ └── maven │ └── archetype-metadata.xml └── test └── resources └── projects └── it-basic ├── archetype.properties └── goal.txt The structure is similar to a general Maven project, there are some difference. The src/main/resources/archetype-resources folder stores all template resources used to generate projects from this archetype.The src/main/resources/META-INF/maven-archetype-metadata.xml is the archetype description file, including the properties, file sets etc.The src/test/resources/projects includes resources to test this archetype, including the properties applied to generate new projects and the goal run in the host integration-test phase. Preparing the archetype resources To simplify the work, I reuse the sample codes from jakartaee9-starter-boilerplate. Copy GreetingMessage, GreetingService, GreetingService and JaxrsActivator to the src/main/resources/archetype-resources/src/main/java folder. Change the package declaration to the following. package $package; … 2. Similar to the last step, copy the GreetingResourceTest and GreetingServiceTest to the src/main/resources/archetype-resources/src/test/java folder. Remember changing the package declaration. 3. Add empty beans.xmlfile to the src/main/resources/archetype-resources/src/main/resources/META-INF/ folder. &lt;beans xmlns=”https://jakarta.ee/xml/ns/jakartaee&quot; xmlns:xsi=”http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=”https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/beans_3_0.xsd&quot; version=”3.0&quot;&gt; &lt;/beans&gt; 4. Add a simple arquillian.xml to the src/main/resources/archetype-resources/src/test/resources folder. &lt;arquillian xmlns:xsi=”http://www.w3.org/2001/XMLSchema-instance&quot; xmlns=”http://jboss.org/schema/arquillian&quot; xsi:schemaLocation=”http://jboss.org/schema/arquillian http://jboss.org/schema/arquillian/arquillian_1_0.xsd&quot;&gt; &lt;defaultProtocol type=”Servlet 5.0&quot;/&gt; &lt;engine&gt; &lt;property name=”deploymentExportPath”&gt;target/&lt;/property&gt; &lt;/engine&gt; &lt;container qualifier=”glassfish” default=”true”&gt; &lt;configuration&gt; &lt;property name=”adminHost”&gt;localhost&lt;/property&gt; &lt;property name=”adminPort”&gt;4848&lt;/property&gt; &lt;property name=”adminUser”&gt;admin&lt;/property&gt; &lt;! — if https is enabled via `asadmin enable-secure-admin` on a remote server → &lt;! — &lt;property name=”adminHttps”&gt;true&lt;/property&gt; → &lt;! — if admin password is changed via `asadmin change-admin-password` → &lt;! — &lt;property name=”adminPassword”&gt;adminadmin&lt;/property&gt; → &lt;! — default is empty → &lt;property name=”adminPassword”&gt;&lt;/property&gt; &lt;/configuration&gt; &lt;/container&gt; &lt;/arquillian&gt; 5. Change the pom.xml template (src/main/resources/archetype-resources/pom.xml) to the following. &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;${groupId}&lt;/groupId&gt; &lt;artifactId&gt;${artifactId}&lt;/artifactId&gt; &lt;version&gt;${version}&lt;/version&gt; &lt;packaging&gt;war&lt;/packaging&gt; &lt;name&gt;${artifactId}&lt;/name&gt; &lt;description&gt;A Jakarta EE starter boilerplate for Jakarta EE 9&lt;/description&gt; &lt;properties&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt; &lt;!-- Official Maven Plugins --&gt; &lt;maven-compiler-plugin.version&gt;3.8.1&lt;/maven-compiler-plugin.version&gt; &lt;maven-war-plugin.version&gt;3.3.1&lt;/maven-war-plugin.version&gt; &lt;maven-dependency-plugin.version&gt;3.1.2&lt;/maven-dependency-plugin.version&gt; &lt;maven-surefire-plugin.version&gt;3.0.0-M5&lt;/maven-surefire-plugin.version&gt; &lt;maven-failsafe-plugin.version&gt;3.0.0-M5&lt;/maven-failsafe-plugin.version&gt; &lt;maven-surefire-report-plugin.version&gt;3.0.0-M5&lt;/maven-surefire-report-plugin.version&gt; &lt;!-- Cargo maven plugin --&gt; &lt;!-- Since 1.9.0, cargo-maven3-plugin is the default for cargo prefix. --&gt; &lt;cargo-maven3-plugin.version&gt;1.9.0&lt;/cargo-maven3-plugin.version&gt; &lt;!-- Jakarta EE API --&gt; &lt;jakartaee-api.version&gt;9.0.0&lt;/jakartaee-api.version&gt; &lt;!-- Arquillian BOM --&gt; &lt;arquillian-bom.version&gt;1.7.0.Alpha9&lt;/arquillian-bom.version&gt; &lt;junit-jupiter.version&gt;5.7.1&lt;/junit-jupiter.version&gt; &lt;!-- Glassfish server --&gt; &lt;glassfish.version&gt;6.0.0&lt;/glassfish.version&gt; &lt;arquillian-glassfish6.version&gt;1.0.0.Alpha1&lt;/arquillian-glassfish6.version&gt; &lt;jersey.version&gt;3.0.1&lt;/jersey.version&gt; &lt;!-- by default skip tests --&gt; &lt;skipTests&gt;true&lt;/skipTests&gt; &lt;/properties&gt; &lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;jakarta.platform&lt;/groupId&gt; &lt;artifactId&gt;jakarta.jakartaee-api&lt;/artifactId&gt; &lt;version&gt;${jakartaee-api.version}&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.jboss.arquillian&lt;/groupId&gt; &lt;artifactId&gt;arquillian-bom&lt;/artifactId&gt; &lt;version&gt;${arquillian-bom.version}&lt;/version&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;type&gt;pom&lt;/type&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.junit&lt;/groupId&gt; &lt;artifactId&gt;junit-bom&lt;/artifactId&gt; &lt;version&gt;${junit-jupiter.version}&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;jakarta.platform&lt;/groupId&gt; &lt;artifactId&gt;jakarta.jakartaee-api&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.jboss.arquillian.junit5&lt;/groupId&gt; &lt;artifactId&gt;arquillian-junit5-container&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- see: https://github.com/arquillian/arquillian-core/issues/248 --&gt; &lt;!-- and https://github.com/arquillian/arquillian-core/pull/246/files --&gt; &lt;dependency&gt; &lt;groupId&gt;org.jboss.arquillian.protocol&lt;/groupId&gt; &lt;artifactId&gt;arquillian-protocol-servlet-jakarta&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt; &lt;artifactId&gt;junit-jupiter&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;finalName&gt;${project.artifactId}&lt;/finalName&gt; &lt;pluginManagement&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt; &lt;artifactId&gt;cargo-maven3-plugin&lt;/artifactId&gt; &lt;version&gt;${cargo-maven3-plugin.version}&lt;/version&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/pluginManagement&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;version&gt;${maven-compiler-plugin.version}&lt;/version&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt; &lt;version&gt;${maven-war-plugin.version}&lt;/version&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; &lt;profiles&gt; &lt;profile&gt; &lt;id&gt;glassfish&lt;/id&gt; &lt;activation&gt; &lt;activeByDefault&gt;true&lt;/activeByDefault&gt; &lt;/activation&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt; &lt;artifactId&gt;cargo-maven3-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;container&gt; &lt;containerId&gt;glassfish6x&lt;/containerId&gt; &lt;artifactInstaller&gt; &lt;groupId&gt;org.glassfish.main.distributions&lt;/groupId&gt; &lt;artifactId&gt;glassfish&lt;/artifactId&gt; &lt;version&gt;${glassfish.version}&lt;/version&gt; &lt;/artifactInstaller&gt; &lt;/container&gt; &lt;configuration&gt; &lt;!-- the configuration used to deploy --&gt; &lt;home&gt;${project.build.directory}/glassfish6x-home&lt;/home&gt; &lt;properties&gt; &lt;cargo.remote.password&gt;&lt;/cargo.remote.password&gt; &lt;/properties&gt; &lt;/configuration&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; &lt;dependencies&gt; &lt;!-- Jersey --&gt; &lt;dependency&gt; &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt; &lt;artifactId&gt;jersey-media-sse&lt;/artifactId&gt; &lt;version&gt;${jersey.version}&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt; &lt;artifactId&gt;jersey-media-json-binding&lt;/artifactId&gt; &lt;version&gt;${jersey.version}&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.glassfish.jersey.inject&lt;/groupId&gt; &lt;artifactId&gt;jersey-hk2&lt;/artifactId&gt; &lt;version&gt;${jersey.version}&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt; &lt;artifactId&gt;jersey-client&lt;/artifactId&gt; &lt;version&gt;${jersey.version}&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.jboss.arquillian.container&lt;/groupId&gt; &lt;artifactId&gt;arquillian-glassfish-remote-6&lt;/artifactId&gt; &lt;version&gt;${arquillian-glassfish6.version}&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/profile&gt; &lt;/profiles&gt;&lt;/project&gt; Note, the value of groupId, artifactId and version elements in this xml refers to a placeholder which can be intercepted in the generating stage. 6. Change the archetype descriptor (src/main/resources/META-INF/maven/archetype-metadata.xml) to the following. &lt;archetype-descriptor xmlns=”http://maven.apache.org/plugins/maven-archetype-plugin/archetype-descriptor/1.0.0&quot; xmlns:xsi=”http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=”http://maven.apache.org/plugins/maven-archetype-plugin/archetype-descriptor/1.0.0 http://maven.apache.org/xsd/archetype-descriptor-1.0.0.xsd&quot; name=”${artifactId}”&gt; &lt;fileSets&gt; &lt;fileSet filtered=”true” packaged=”true”&gt; &lt;directory&gt;src/main/java&lt;/directory&gt; &lt;/fileSet&gt; &lt;fileSet&gt; &lt;directory&gt;src/main/resources&lt;/directory&gt; &lt;/fileSet&gt; &lt;fileSet filtered=”true” packaged=”true”&gt; &lt;directory&gt;src/test/java&lt;/directory&gt; &lt;/fileSet&gt; &lt;fileSet&gt; &lt;directory&gt;src/test/resources&lt;/directory&gt; &lt;/fileSet&gt; &lt;/fileSets&gt; &lt;/archetype-descriptor&gt; In the above codes, when the filtered attribute is set to true, it will replace the placeholders(eg. $package, etc.) you have set in the template files with the parameters when executing mvn archetype:generate to generate projects. And when the packaged attribute is set to true, it will move the generated file to corresponding packages. To test the archetype resources, there is a archetype.properties and a goal.txt file prepared in the src/test/resources/projects/it-basic. In the integration-test phase, it will generate a test project using archetype resources and replace the placeholders using the properties defined in the archetype.properties and execute goals in the goal.txt against the generated project. I created a Github Actions workflow to verify the generated projects. Publishing to Maven Central Repository Note, the steps of publishing your packages to the Maven Central repository is a little tedious, please be patient. Once you have built the maven archetype project successfully, the next step is publishing it to Maven Central repository and make it public, there are some useful guides in Google results. I suggest you pick one or more from the following list and read it firstly. Publish JAR To Central Maven RepositoryHow to Publish Your Artifacts to Maven CentralCreate your own Maven Archetype in 5 simple steps Register an account of the Sonatype issue tracker.File a new issue on Community Support to submit your request of publishing your artifact. Check my issue#OSSRH-66424 I created for hantsy/maven-archetype-jakartaee9 as an example.Follow the response of the issue, create a new empty repo(the name is the issue id) on Github for authentication requirement. eg. OSSRH-66424Generate GPG keys and send to key servers. Under Windows 10 system, you have to install GPG tools firstly. Simply run the following command to install gpg4win if you are using Chocolatey. choco install gpg4win Refresh the environment. refreshenv Then generate GPG keys. # gpg — full-gen-key gpg (GnuPG) 2.2.27; Copyright © 2021 g10 Code GmbH This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. Please select what kind of key you want: (1) RSA and RSA (default) (2) DSA and Elgamal (3) DSA (sign only) (4) RSA (sign only) (14) Existing key from card Your selection? 1 RSA keys may be between 1024 and 4096 bits long. What keysize do you want? (3072) Requested keysize is 3072 bits Please specify how long the key should be valid. 0 = key does not expire &lt;n&gt; = key expires in n days &lt;n&gt;w = key expires in n weeks &lt;n&gt;m = key expires in n months &lt;n&gt;y = key expires in n years Key is valid for? (0) Key does not expire at all Is this correct? (y/N) y GnuPG needs to construct a user ID to identify your key. Real name: Hantsy Bai Email address: hantsy@gmail.com Comment: You selected this USER-ID: “Hantsy Bai &lt;hantsy@gmail.com&gt;” Change (N)ame, ©omment, (E)mail or (O)kay/(Q)uit? O We need to generate a lot of random bytes. It is a good idea to perform some other action (type on the keyboard, move the mouse, utilize the disks) during the prime generation; this gives the random number generator a better chance to gain enough entropy. gpg: AllowSetForegroundWindow(9152) failed: Access is denied. We need to generate a lot of random bytes. It is a good idea to perform some other action (type on the keyboard, move the mouse, utilize the disks) during the prime generation; this gives the random number generator a better chance to gain enough entropy. gpg: C:/Users/hantsy/AppData/Roaming/gnupg/trustdb.gpg: trustdb created gpg: key E5D9B4272348ADAE marked as ultimately trusted gpg: directory ‘C:/Users/hantsy/AppData/Roaming/gnupg/openpgp-revocs.d’ created gpg: revocation certificate stored as ‘C:/Users/hantsy/AppData/Roaming/gnupg/openpgp-revocs.d\03B4C55DDA964D942C756D79E5D9B4272348ADAE.rev’ public and secret key created and signed. pub rsa3072 2021–03–30 [SC] 03B4C55DDA964D942C756D79E5D9B4272348ADAE uid Hantsy Bai &lt;hantsy@gmail.com&gt; sub rsa3072 2021–03–30 [E] Send the keys to the public key servers. # gpg — send-keys 03B4C55DDA964D942C756D79E5D9B4272348ADAE gpg: sending key E5D9B4272348ADAE to hkps://hkps.pool.sks-keyservers.net 5. Follow the steps of Deploying to OSSRH with Apache Maven to publish your artifact. I skip the detailed steps here, please read the Synatype’s article carefully. 6. Then back to the issue#OSSRH-66424, comment and notify the moderator to publish your artifact to the Maven Central repository. In one or two hours, your artifact will be available on Maven Central Repository Search index page. Publishing to Github Package The Configuring Apache Maven for use with GitHub Packages page provides detailed steps to publish a package to Github Packages. Following the steps of Authenticating to Github Packages to set the Github authentication info in your ~/.m2/settings.xml file.Deploy to Github Packages. In our case, we have set the distributionManagement to use the Maven Central repository. Use the following command instead. mvn clean package deploy -DskipTests -DaltDeploymentRepository=github::https://maven.pkg.github.com/hantsy/maven-archetype-jakartaee9 By default, Github Packages does not allow anyone to access your repository without an authentication. After consulting from Github community, there is a solution to resolve this issue gracefully, it is possible to make your repository accessible to the public.Generate a Personal Access Token with packages:read scope.Run the following command to generate the repository config. # docker run ghcr.io/jcansdale/gpr encode &lt;your PAT&gt; A NuGet `nuget.config` file: &lt;packageSourceCredentials&gt; &lt;github&gt; &lt;add key=”Username” value=”PublicToken” /&gt; &lt;add key=”ClearTextPassword” value=”&amp;#48;28d0c8f723084e499eb87a6fe173b3af295d618&quot; /&gt; &lt;/github&gt; &lt;/packageSourceCredentials&gt; A Maven `pom.xml` file: &lt;repositories&gt; &lt;repository&gt; &lt;id&gt;github-public&lt;/id&gt; &lt;url&gt;https://public:&amp;#48;28d0c8f723084e499eb87a6fe173b3af295d618@maven.pkg.github.com/&lt;OWNER&gt;/*&lt;/url&gt; &lt;/repository&gt; &lt;/repositories&gt; An npm `.npmrc` file: @OWNER:registry=https://npm.pkg.github.com //npm.pkg.github.com/:_authToken=”\u003028d0c8f723084e499eb87a6fe173b3af295d618&quot; As you see, now you can add the above repository to your Maven proxy server or global Maven settings(~/.m2/settings.xml) in your system. Check the source codes from my Github. &lt;hr&gt;&lt;p&gt;Building your own Maven archetype was originally published in ITNEXT on Medium, where people are continuing the conversation by highlighting and responding to this story.&lt;/p&gt;" />
<meta property="og:description" content="Github is easy to share codes with others, for example I created jakartaee9-starter-boilerplate as a project template for Jakarta EE developers. For those who are familiar with Github, it is easy to start their new projects by forking or cloning this project directly. But obviously for a general Jakarta EE application, you do not need the configuraitons of all application severs, eg. Glassfish/Payara, WildFly, OpenLiberty, Apache TomEE, etc. For most of Java developers esp. Maven users, a simple and clean Maven archetype is still the preferred option to generate the new project skeleton, and you can add the required configuration back later. I had created some maven archetype like toys myself in the past years, but I never made them public through the Maven Central repository. In this post, I will replay the steps of creating the Maven Archetype for Jakarta EE 9 and the followed steps of publishing it to the Maven Central repository and making it public to the world. A better formatted version is published on dev.to, https://dev.to/hantsy_26/building-your-own-maven-archetype-gm8 Generating the archetype project skeleton Maven archetype is the Maven specific templates used to generate a new project in the Maven build system. Maven itself provides an official archetype (maven-archetype-archetype) for you to build your own Maven archetype. The official archetype introduction page lists all official archetypes. Run the following command to generate the archetype project in an interactive mode. mvn archetype:generate When you hit down the Enter key, it will take some seconds to list all available archetypes. Every archetype is attached to a number. Type the number of maven-archetype-archetype , then it will ask you to fill groupId, archetypeId, package and version of your project. After all fields are filled as expected, it will generate the project in seconds. Alternatively, you can generate the project in a single command aka the batch mode. mvn archetype:generate -B \-DarchetypeGroupId=org.apache.maven.archetypes \-DarchetypeArtifactId=maven-archetype-archetype \-DarchetypeVersion=1.4 \-DgroupId=io.github.hantsy \-DartifactId=maven-archetype-jakartaee9 \-Dversion=1.0-SNAPSHOT Note here we use the -B parameter in the command line to skip the interactive questionnaire steps and run the command in batch mode. More info about Maven archetype and maven-archetype-plugin, please check Maven Archetype. Exploring the project structure Import the project into your IDEs, such as Apache NetBeans, IntelliJ IDEA, etc. You will see the following project file structure. ├── pom.xml└── src ├── main │ └── resources │ ├── archetype-resources │ │ ├── pom.xml │ │ └── src │ │ ├── main │ │ │ └── java │ │ │ └── App.java │ │ └── test │ │ └── java │ │ └── AppTest.java │ └── META-INF │ └── maven │ └── archetype-metadata.xml └── test └── resources └── projects └── it-basic ├── archetype.properties └── goal.txt The structure is similar to a general Maven project, there are some difference. The src/main/resources/archetype-resources folder stores all template resources used to generate projects from this archetype.The src/main/resources/META-INF/maven-archetype-metadata.xml is the archetype description file, including the properties, file sets etc.The src/test/resources/projects includes resources to test this archetype, including the properties applied to generate new projects and the goal run in the host integration-test phase. Preparing the archetype resources To simplify the work, I reuse the sample codes from jakartaee9-starter-boilerplate. Copy GreetingMessage, GreetingService, GreetingService and JaxrsActivator to the src/main/resources/archetype-resources/src/main/java folder. Change the package declaration to the following. package $package; … 2. Similar to the last step, copy the GreetingResourceTest and GreetingServiceTest to the src/main/resources/archetype-resources/src/test/java folder. Remember changing the package declaration. 3. Add empty beans.xmlfile to the src/main/resources/archetype-resources/src/main/resources/META-INF/ folder. &lt;beans xmlns=”https://jakarta.ee/xml/ns/jakartaee&quot; xmlns:xsi=”http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=”https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/beans_3_0.xsd&quot; version=”3.0&quot;&gt; &lt;/beans&gt; 4. Add a simple arquillian.xml to the src/main/resources/archetype-resources/src/test/resources folder. &lt;arquillian xmlns:xsi=”http://www.w3.org/2001/XMLSchema-instance&quot; xmlns=”http://jboss.org/schema/arquillian&quot; xsi:schemaLocation=”http://jboss.org/schema/arquillian http://jboss.org/schema/arquillian/arquillian_1_0.xsd&quot;&gt; &lt;defaultProtocol type=”Servlet 5.0&quot;/&gt; &lt;engine&gt; &lt;property name=”deploymentExportPath”&gt;target/&lt;/property&gt; &lt;/engine&gt; &lt;container qualifier=”glassfish” default=”true”&gt; &lt;configuration&gt; &lt;property name=”adminHost”&gt;localhost&lt;/property&gt; &lt;property name=”adminPort”&gt;4848&lt;/property&gt; &lt;property name=”adminUser”&gt;admin&lt;/property&gt; &lt;! — if https is enabled via `asadmin enable-secure-admin` on a remote server → &lt;! — &lt;property name=”adminHttps”&gt;true&lt;/property&gt; → &lt;! — if admin password is changed via `asadmin change-admin-password` → &lt;! — &lt;property name=”adminPassword”&gt;adminadmin&lt;/property&gt; → &lt;! — default is empty → &lt;property name=”adminPassword”&gt;&lt;/property&gt; &lt;/configuration&gt; &lt;/container&gt; &lt;/arquillian&gt; 5. Change the pom.xml template (src/main/resources/archetype-resources/pom.xml) to the following. &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;${groupId}&lt;/groupId&gt; &lt;artifactId&gt;${artifactId}&lt;/artifactId&gt; &lt;version&gt;${version}&lt;/version&gt; &lt;packaging&gt;war&lt;/packaging&gt; &lt;name&gt;${artifactId}&lt;/name&gt; &lt;description&gt;A Jakarta EE starter boilerplate for Jakarta EE 9&lt;/description&gt; &lt;properties&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt; &lt;!-- Official Maven Plugins --&gt; &lt;maven-compiler-plugin.version&gt;3.8.1&lt;/maven-compiler-plugin.version&gt; &lt;maven-war-plugin.version&gt;3.3.1&lt;/maven-war-plugin.version&gt; &lt;maven-dependency-plugin.version&gt;3.1.2&lt;/maven-dependency-plugin.version&gt; &lt;maven-surefire-plugin.version&gt;3.0.0-M5&lt;/maven-surefire-plugin.version&gt; &lt;maven-failsafe-plugin.version&gt;3.0.0-M5&lt;/maven-failsafe-plugin.version&gt; &lt;maven-surefire-report-plugin.version&gt;3.0.0-M5&lt;/maven-surefire-report-plugin.version&gt; &lt;!-- Cargo maven plugin --&gt; &lt;!-- Since 1.9.0, cargo-maven3-plugin is the default for cargo prefix. --&gt; &lt;cargo-maven3-plugin.version&gt;1.9.0&lt;/cargo-maven3-plugin.version&gt; &lt;!-- Jakarta EE API --&gt; &lt;jakartaee-api.version&gt;9.0.0&lt;/jakartaee-api.version&gt; &lt;!-- Arquillian BOM --&gt; &lt;arquillian-bom.version&gt;1.7.0.Alpha9&lt;/arquillian-bom.version&gt; &lt;junit-jupiter.version&gt;5.7.1&lt;/junit-jupiter.version&gt; &lt;!-- Glassfish server --&gt; &lt;glassfish.version&gt;6.0.0&lt;/glassfish.version&gt; &lt;arquillian-glassfish6.version&gt;1.0.0.Alpha1&lt;/arquillian-glassfish6.version&gt; &lt;jersey.version&gt;3.0.1&lt;/jersey.version&gt; &lt;!-- by default skip tests --&gt; &lt;skipTests&gt;true&lt;/skipTests&gt; &lt;/properties&gt; &lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;jakarta.platform&lt;/groupId&gt; &lt;artifactId&gt;jakarta.jakartaee-api&lt;/artifactId&gt; &lt;version&gt;${jakartaee-api.version}&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.jboss.arquillian&lt;/groupId&gt; &lt;artifactId&gt;arquillian-bom&lt;/artifactId&gt; &lt;version&gt;${arquillian-bom.version}&lt;/version&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;type&gt;pom&lt;/type&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.junit&lt;/groupId&gt; &lt;artifactId&gt;junit-bom&lt;/artifactId&gt; &lt;version&gt;${junit-jupiter.version}&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;jakarta.platform&lt;/groupId&gt; &lt;artifactId&gt;jakarta.jakartaee-api&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.jboss.arquillian.junit5&lt;/groupId&gt; &lt;artifactId&gt;arquillian-junit5-container&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- see: https://github.com/arquillian/arquillian-core/issues/248 --&gt; &lt;!-- and https://github.com/arquillian/arquillian-core/pull/246/files --&gt; &lt;dependency&gt; &lt;groupId&gt;org.jboss.arquillian.protocol&lt;/groupId&gt; &lt;artifactId&gt;arquillian-protocol-servlet-jakarta&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt; &lt;artifactId&gt;junit-jupiter&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;finalName&gt;${project.artifactId}&lt;/finalName&gt; &lt;pluginManagement&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt; &lt;artifactId&gt;cargo-maven3-plugin&lt;/artifactId&gt; &lt;version&gt;${cargo-maven3-plugin.version}&lt;/version&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/pluginManagement&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;version&gt;${maven-compiler-plugin.version}&lt;/version&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt; &lt;version&gt;${maven-war-plugin.version}&lt;/version&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; &lt;profiles&gt; &lt;profile&gt; &lt;id&gt;glassfish&lt;/id&gt; &lt;activation&gt; &lt;activeByDefault&gt;true&lt;/activeByDefault&gt; &lt;/activation&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt; &lt;artifactId&gt;cargo-maven3-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;container&gt; &lt;containerId&gt;glassfish6x&lt;/containerId&gt; &lt;artifactInstaller&gt; &lt;groupId&gt;org.glassfish.main.distributions&lt;/groupId&gt; &lt;artifactId&gt;glassfish&lt;/artifactId&gt; &lt;version&gt;${glassfish.version}&lt;/version&gt; &lt;/artifactInstaller&gt; &lt;/container&gt; &lt;configuration&gt; &lt;!-- the configuration used to deploy --&gt; &lt;home&gt;${project.build.directory}/glassfish6x-home&lt;/home&gt; &lt;properties&gt; &lt;cargo.remote.password&gt;&lt;/cargo.remote.password&gt; &lt;/properties&gt; &lt;/configuration&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; &lt;dependencies&gt; &lt;!-- Jersey --&gt; &lt;dependency&gt; &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt; &lt;artifactId&gt;jersey-media-sse&lt;/artifactId&gt; &lt;version&gt;${jersey.version}&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt; &lt;artifactId&gt;jersey-media-json-binding&lt;/artifactId&gt; &lt;version&gt;${jersey.version}&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.glassfish.jersey.inject&lt;/groupId&gt; &lt;artifactId&gt;jersey-hk2&lt;/artifactId&gt; &lt;version&gt;${jersey.version}&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt; &lt;artifactId&gt;jersey-client&lt;/artifactId&gt; &lt;version&gt;${jersey.version}&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.jboss.arquillian.container&lt;/groupId&gt; &lt;artifactId&gt;arquillian-glassfish-remote-6&lt;/artifactId&gt; &lt;version&gt;${arquillian-glassfish6.version}&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/profile&gt; &lt;/profiles&gt;&lt;/project&gt; Note, the value of groupId, artifactId and version elements in this xml refers to a placeholder which can be intercepted in the generating stage. 6. Change the archetype descriptor (src/main/resources/META-INF/maven/archetype-metadata.xml) to the following. &lt;archetype-descriptor xmlns=”http://maven.apache.org/plugins/maven-archetype-plugin/archetype-descriptor/1.0.0&quot; xmlns:xsi=”http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=”http://maven.apache.org/plugins/maven-archetype-plugin/archetype-descriptor/1.0.0 http://maven.apache.org/xsd/archetype-descriptor-1.0.0.xsd&quot; name=”${artifactId}”&gt; &lt;fileSets&gt; &lt;fileSet filtered=”true” packaged=”true”&gt; &lt;directory&gt;src/main/java&lt;/directory&gt; &lt;/fileSet&gt; &lt;fileSet&gt; &lt;directory&gt;src/main/resources&lt;/directory&gt; &lt;/fileSet&gt; &lt;fileSet filtered=”true” packaged=”true”&gt; &lt;directory&gt;src/test/java&lt;/directory&gt; &lt;/fileSet&gt; &lt;fileSet&gt; &lt;directory&gt;src/test/resources&lt;/directory&gt; &lt;/fileSet&gt; &lt;/fileSets&gt; &lt;/archetype-descriptor&gt; In the above codes, when the filtered attribute is set to true, it will replace the placeholders(eg. $package, etc.) you have set in the template files with the parameters when executing mvn archetype:generate to generate projects. And when the packaged attribute is set to true, it will move the generated file to corresponding packages. To test the archetype resources, there is a archetype.properties and a goal.txt file prepared in the src/test/resources/projects/it-basic. In the integration-test phase, it will generate a test project using archetype resources and replace the placeholders using the properties defined in the archetype.properties and execute goals in the goal.txt against the generated project. I created a Github Actions workflow to verify the generated projects. Publishing to Maven Central Repository Note, the steps of publishing your packages to the Maven Central repository is a little tedious, please be patient. Once you have built the maven archetype project successfully, the next step is publishing it to Maven Central repository and make it public, there are some useful guides in Google results. I suggest you pick one or more from the following list and read it firstly. Publish JAR To Central Maven RepositoryHow to Publish Your Artifacts to Maven CentralCreate your own Maven Archetype in 5 simple steps Register an account of the Sonatype issue tracker.File a new issue on Community Support to submit your request of publishing your artifact. Check my issue#OSSRH-66424 I created for hantsy/maven-archetype-jakartaee9 as an example.Follow the response of the issue, create a new empty repo(the name is the issue id) on Github for authentication requirement. eg. OSSRH-66424Generate GPG keys and send to key servers. Under Windows 10 system, you have to install GPG tools firstly. Simply run the following command to install gpg4win if you are using Chocolatey. choco install gpg4win Refresh the environment. refreshenv Then generate GPG keys. # gpg — full-gen-key gpg (GnuPG) 2.2.27; Copyright © 2021 g10 Code GmbH This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. Please select what kind of key you want: (1) RSA and RSA (default) (2) DSA and Elgamal (3) DSA (sign only) (4) RSA (sign only) (14) Existing key from card Your selection? 1 RSA keys may be between 1024 and 4096 bits long. What keysize do you want? (3072) Requested keysize is 3072 bits Please specify how long the key should be valid. 0 = key does not expire &lt;n&gt; = key expires in n days &lt;n&gt;w = key expires in n weeks &lt;n&gt;m = key expires in n months &lt;n&gt;y = key expires in n years Key is valid for? (0) Key does not expire at all Is this correct? (y/N) y GnuPG needs to construct a user ID to identify your key. Real name: Hantsy Bai Email address: hantsy@gmail.com Comment: You selected this USER-ID: “Hantsy Bai &lt;hantsy@gmail.com&gt;” Change (N)ame, ©omment, (E)mail or (O)kay/(Q)uit? O We need to generate a lot of random bytes. It is a good idea to perform some other action (type on the keyboard, move the mouse, utilize the disks) during the prime generation; this gives the random number generator a better chance to gain enough entropy. gpg: AllowSetForegroundWindow(9152) failed: Access is denied. We need to generate a lot of random bytes. It is a good idea to perform some other action (type on the keyboard, move the mouse, utilize the disks) during the prime generation; this gives the random number generator a better chance to gain enough entropy. gpg: C:/Users/hantsy/AppData/Roaming/gnupg/trustdb.gpg: trustdb created gpg: key E5D9B4272348ADAE marked as ultimately trusted gpg: directory ‘C:/Users/hantsy/AppData/Roaming/gnupg/openpgp-revocs.d’ created gpg: revocation certificate stored as ‘C:/Users/hantsy/AppData/Roaming/gnupg/openpgp-revocs.d\03B4C55DDA964D942C756D79E5D9B4272348ADAE.rev’ public and secret key created and signed. pub rsa3072 2021–03–30 [SC] 03B4C55DDA964D942C756D79E5D9B4272348ADAE uid Hantsy Bai &lt;hantsy@gmail.com&gt; sub rsa3072 2021–03–30 [E] Send the keys to the public key servers. # gpg — send-keys 03B4C55DDA964D942C756D79E5D9B4272348ADAE gpg: sending key E5D9B4272348ADAE to hkps://hkps.pool.sks-keyservers.net 5. Follow the steps of Deploying to OSSRH with Apache Maven to publish your artifact. I skip the detailed steps here, please read the Synatype’s article carefully. 6. Then back to the issue#OSSRH-66424, comment and notify the moderator to publish your artifact to the Maven Central repository. In one or two hours, your artifact will be available on Maven Central Repository Search index page. Publishing to Github Package The Configuring Apache Maven for use with GitHub Packages page provides detailed steps to publish a package to Github Packages. Following the steps of Authenticating to Github Packages to set the Github authentication info in your ~/.m2/settings.xml file.Deploy to Github Packages. In our case, we have set the distributionManagement to use the Maven Central repository. Use the following command instead. mvn clean package deploy -DskipTests -DaltDeploymentRepository=github::https://maven.pkg.github.com/hantsy/maven-archetype-jakartaee9 By default, Github Packages does not allow anyone to access your repository without an authentication. After consulting from Github community, there is a solution to resolve this issue gracefully, it is possible to make your repository accessible to the public.Generate a Personal Access Token with packages:read scope.Run the following command to generate the repository config. # docker run ghcr.io/jcansdale/gpr encode &lt;your PAT&gt; A NuGet `nuget.config` file: &lt;packageSourceCredentials&gt; &lt;github&gt; &lt;add key=”Username” value=”PublicToken” /&gt; &lt;add key=”ClearTextPassword” value=”&amp;#48;28d0c8f723084e499eb87a6fe173b3af295d618&quot; /&gt; &lt;/github&gt; &lt;/packageSourceCredentials&gt; A Maven `pom.xml` file: &lt;repositories&gt; &lt;repository&gt; &lt;id&gt;github-public&lt;/id&gt; &lt;url&gt;https://public:&amp;#48;28d0c8f723084e499eb87a6fe173b3af295d618@maven.pkg.github.com/&lt;OWNER&gt;/*&lt;/url&gt; &lt;/repository&gt; &lt;/repositories&gt; An npm `.npmrc` file: @OWNER:registry=https://npm.pkg.github.com //npm.pkg.github.com/:_authToken=”\u003028d0c8f723084e499eb87a6fe173b3af295d618&quot; As you see, now you can add the above repository to your Maven proxy server or global Maven settings(~/.m2/settings.xml) in your system. Check the source codes from my Github. &lt;hr&gt;&lt;p&gt;Building your own Maven archetype was originally published in ITNEXT on Medium, where people are continuing the conversation by highlighting and responding to this story.&lt;/p&gt;" />
<meta property="og:site_name" content="blank" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-04-06T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Building your own Maven archetype" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-04-06T00:00:00+00:00","datePublished":"2021-04-06T00:00:00+00:00","description":"Github is easy to share codes with others, for example I created jakartaee9-starter-boilerplate as a project template for Jakarta EE developers. For those who are familiar with Github, it is easy to start their new projects by forking or cloning this project directly. But obviously for a general Jakarta EE application, you do not need the configuraitons of all application severs, eg. Glassfish/Payara, WildFly, OpenLiberty, Apache TomEE, etc. For most of Java developers esp. Maven users, a simple and clean Maven archetype is still the preferred option to generate the new project skeleton, and you can add the required configuration back later. I had created some maven archetype like toys myself in the past years, but I never made them public through the Maven Central repository. In this post, I will replay the steps of creating the Maven Archetype for Jakarta EE 9 and the followed steps of publishing it to the Maven Central repository and making it public to the world. A better formatted version is published on dev.to, https://dev.to/hantsy_26/building-your-own-maven-archetype-gm8 Generating the archetype project skeleton Maven archetype is the Maven specific templates used to generate a new project in the Maven build system. Maven itself provides an official archetype (maven-archetype-archetype) for you to build your own Maven archetype. The official archetype introduction page lists all official archetypes. Run the following command to generate the archetype project in an interactive mode. mvn archetype:generate When you hit down the Enter key, it will take some seconds to list all available archetypes. Every archetype is attached to a number. Type the number of maven-archetype-archetype , then it will ask you to fill groupId, archetypeId, package and version of your project. After all fields are filled as expected, it will generate the project in seconds. Alternatively, you can generate the project in a single command aka the batch mode. mvn archetype:generate -B \\-DarchetypeGroupId=org.apache.maven.archetypes \\-DarchetypeArtifactId=maven-archetype-archetype \\-DarchetypeVersion=1.4 \\-DgroupId=io.github.hantsy \\-DartifactId=maven-archetype-jakartaee9 \\-Dversion=1.0-SNAPSHOT Note here we use the -B parameter in the command line to skip the interactive questionnaire steps and run the command in batch mode. More info about Maven archetype and maven-archetype-plugin, please check Maven Archetype. Exploring the project structure Import the project into your IDEs, such as Apache NetBeans, IntelliJ IDEA, etc. You will see the following project file structure. ├── pom.xml└── src ├── main │ └── resources │ ├── archetype-resources │ │ ├── pom.xml │ │ └── src │ │ ├── main │ │ │ └── java │ │ │ └── App.java │ │ └── test │ │ └── java │ │ └── AppTest.java │ └── META-INF │ └── maven │ └── archetype-metadata.xml └── test └── resources └── projects └── it-basic ├── archetype.properties └── goal.txt The structure is similar to a general Maven project, there are some difference. The src/main/resources/archetype-resources folder stores all template resources used to generate projects from this archetype.The src/main/resources/META-INF/maven-archetype-metadata.xml is the archetype description file, including the properties, file sets etc.The src/test/resources/projects includes resources to test this archetype, including the properties applied to generate new projects and the goal run in the host integration-test phase. Preparing the archetype resources To simplify the work, I reuse the sample codes from jakartaee9-starter-boilerplate. Copy GreetingMessage, GreetingService, GreetingService and JaxrsActivator to the src/main/resources/archetype-resources/src/main/java folder. Change the package declaration to the following. package $package; … 2. Similar to the last step, copy the GreetingResourceTest and GreetingServiceTest to the src/main/resources/archetype-resources/src/test/java folder. Remember changing the package declaration. 3. Add empty beans.xmlfile to the src/main/resources/archetype-resources/src/main/resources/META-INF/ folder. &lt;beans xmlns=”https://jakarta.ee/xml/ns/jakartaee&quot; xmlns:xsi=”http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=”https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/beans_3_0.xsd&quot; version=”3.0&quot;&gt; &lt;/beans&gt; 4. Add a simple arquillian.xml to the src/main/resources/archetype-resources/src/test/resources folder. &lt;arquillian xmlns:xsi=”http://www.w3.org/2001/XMLSchema-instance&quot; xmlns=”http://jboss.org/schema/arquillian&quot; xsi:schemaLocation=”http://jboss.org/schema/arquillian http://jboss.org/schema/arquillian/arquillian_1_0.xsd&quot;&gt; &lt;defaultProtocol type=”Servlet 5.0&quot;/&gt; &lt;engine&gt; &lt;property name=”deploymentExportPath”&gt;target/&lt;/property&gt; &lt;/engine&gt; &lt;container qualifier=”glassfish” default=”true”&gt; &lt;configuration&gt; &lt;property name=”adminHost”&gt;localhost&lt;/property&gt; &lt;property name=”adminPort”&gt;4848&lt;/property&gt; &lt;property name=”adminUser”&gt;admin&lt;/property&gt; &lt;! — if https is enabled via `asadmin enable-secure-admin` on a remote server → &lt;! — &lt;property name=”adminHttps”&gt;true&lt;/property&gt; → &lt;! — if admin password is changed via `asadmin change-admin-password` → &lt;! — &lt;property name=”adminPassword”&gt;adminadmin&lt;/property&gt; → &lt;! — default is empty → &lt;property name=”adminPassword”&gt;&lt;/property&gt; &lt;/configuration&gt; &lt;/container&gt; &lt;/arquillian&gt; 5. Change the pom.xml template (src/main/resources/archetype-resources/pom.xml) to the following. &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;${groupId}&lt;/groupId&gt; &lt;artifactId&gt;${artifactId}&lt;/artifactId&gt; &lt;version&gt;${version}&lt;/version&gt; &lt;packaging&gt;war&lt;/packaging&gt; &lt;name&gt;${artifactId}&lt;/name&gt; &lt;description&gt;A Jakarta EE starter boilerplate for Jakarta EE 9&lt;/description&gt; &lt;properties&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt; &lt;!-- Official Maven Plugins --&gt; &lt;maven-compiler-plugin.version&gt;3.8.1&lt;/maven-compiler-plugin.version&gt; &lt;maven-war-plugin.version&gt;3.3.1&lt;/maven-war-plugin.version&gt; &lt;maven-dependency-plugin.version&gt;3.1.2&lt;/maven-dependency-plugin.version&gt; &lt;maven-surefire-plugin.version&gt;3.0.0-M5&lt;/maven-surefire-plugin.version&gt; &lt;maven-failsafe-plugin.version&gt;3.0.0-M5&lt;/maven-failsafe-plugin.version&gt; &lt;maven-surefire-report-plugin.version&gt;3.0.0-M5&lt;/maven-surefire-report-plugin.version&gt; &lt;!-- Cargo maven plugin --&gt; &lt;!-- Since 1.9.0, cargo-maven3-plugin is the default for cargo prefix. --&gt; &lt;cargo-maven3-plugin.version&gt;1.9.0&lt;/cargo-maven3-plugin.version&gt; &lt;!-- Jakarta EE API --&gt; &lt;jakartaee-api.version&gt;9.0.0&lt;/jakartaee-api.version&gt; &lt;!-- Arquillian BOM --&gt; &lt;arquillian-bom.version&gt;1.7.0.Alpha9&lt;/arquillian-bom.version&gt; &lt;junit-jupiter.version&gt;5.7.1&lt;/junit-jupiter.version&gt; &lt;!-- Glassfish server --&gt; &lt;glassfish.version&gt;6.0.0&lt;/glassfish.version&gt; &lt;arquillian-glassfish6.version&gt;1.0.0.Alpha1&lt;/arquillian-glassfish6.version&gt; &lt;jersey.version&gt;3.0.1&lt;/jersey.version&gt; &lt;!-- by default skip tests --&gt; &lt;skipTests&gt;true&lt;/skipTests&gt; &lt;/properties&gt; &lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;jakarta.platform&lt;/groupId&gt; &lt;artifactId&gt;jakarta.jakartaee-api&lt;/artifactId&gt; &lt;version&gt;${jakartaee-api.version}&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.jboss.arquillian&lt;/groupId&gt; &lt;artifactId&gt;arquillian-bom&lt;/artifactId&gt; &lt;version&gt;${arquillian-bom.version}&lt;/version&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;type&gt;pom&lt;/type&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.junit&lt;/groupId&gt; &lt;artifactId&gt;junit-bom&lt;/artifactId&gt; &lt;version&gt;${junit-jupiter.version}&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;jakarta.platform&lt;/groupId&gt; &lt;artifactId&gt;jakarta.jakartaee-api&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.jboss.arquillian.junit5&lt;/groupId&gt; &lt;artifactId&gt;arquillian-junit5-container&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- see: https://github.com/arquillian/arquillian-core/issues/248 --&gt; &lt;!-- and https://github.com/arquillian/arquillian-core/pull/246/files --&gt; &lt;dependency&gt; &lt;groupId&gt;org.jboss.arquillian.protocol&lt;/groupId&gt; &lt;artifactId&gt;arquillian-protocol-servlet-jakarta&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt; &lt;artifactId&gt;junit-jupiter&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;finalName&gt;${project.artifactId}&lt;/finalName&gt; &lt;pluginManagement&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt; &lt;artifactId&gt;cargo-maven3-plugin&lt;/artifactId&gt; &lt;version&gt;${cargo-maven3-plugin.version}&lt;/version&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/pluginManagement&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;version&gt;${maven-compiler-plugin.version}&lt;/version&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt; &lt;version&gt;${maven-war-plugin.version}&lt;/version&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; &lt;profiles&gt; &lt;profile&gt; &lt;id&gt;glassfish&lt;/id&gt; &lt;activation&gt; &lt;activeByDefault&gt;true&lt;/activeByDefault&gt; &lt;/activation&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt; &lt;artifactId&gt;cargo-maven3-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;container&gt; &lt;containerId&gt;glassfish6x&lt;/containerId&gt; &lt;artifactInstaller&gt; &lt;groupId&gt;org.glassfish.main.distributions&lt;/groupId&gt; &lt;artifactId&gt;glassfish&lt;/artifactId&gt; &lt;version&gt;${glassfish.version}&lt;/version&gt; &lt;/artifactInstaller&gt; &lt;/container&gt; &lt;configuration&gt; &lt;!-- the configuration used to deploy --&gt; &lt;home&gt;${project.build.directory}/glassfish6x-home&lt;/home&gt; &lt;properties&gt; &lt;cargo.remote.password&gt;&lt;/cargo.remote.password&gt; &lt;/properties&gt; &lt;/configuration&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; &lt;dependencies&gt; &lt;!-- Jersey --&gt; &lt;dependency&gt; &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt; &lt;artifactId&gt;jersey-media-sse&lt;/artifactId&gt; &lt;version&gt;${jersey.version}&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt; &lt;artifactId&gt;jersey-media-json-binding&lt;/artifactId&gt; &lt;version&gt;${jersey.version}&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.glassfish.jersey.inject&lt;/groupId&gt; &lt;artifactId&gt;jersey-hk2&lt;/artifactId&gt; &lt;version&gt;${jersey.version}&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt; &lt;artifactId&gt;jersey-client&lt;/artifactId&gt; &lt;version&gt;${jersey.version}&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.jboss.arquillian.container&lt;/groupId&gt; &lt;artifactId&gt;arquillian-glassfish-remote-6&lt;/artifactId&gt; &lt;version&gt;${arquillian-glassfish6.version}&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/profile&gt; &lt;/profiles&gt;&lt;/project&gt; Note, the value of groupId, artifactId and version elements in this xml refers to a placeholder which can be intercepted in the generating stage. 6. Change the archetype descriptor (src/main/resources/META-INF/maven/archetype-metadata.xml) to the following. &lt;archetype-descriptor xmlns=”http://maven.apache.org/plugins/maven-archetype-plugin/archetype-descriptor/1.0.0&quot; xmlns:xsi=”http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=”http://maven.apache.org/plugins/maven-archetype-plugin/archetype-descriptor/1.0.0 http://maven.apache.org/xsd/archetype-descriptor-1.0.0.xsd&quot; name=”${artifactId}”&gt; &lt;fileSets&gt; &lt;fileSet filtered=”true” packaged=”true”&gt; &lt;directory&gt;src/main/java&lt;/directory&gt; &lt;/fileSet&gt; &lt;fileSet&gt; &lt;directory&gt;src/main/resources&lt;/directory&gt; &lt;/fileSet&gt; &lt;fileSet filtered=”true” packaged=”true”&gt; &lt;directory&gt;src/test/java&lt;/directory&gt; &lt;/fileSet&gt; &lt;fileSet&gt; &lt;directory&gt;src/test/resources&lt;/directory&gt; &lt;/fileSet&gt; &lt;/fileSets&gt; &lt;/archetype-descriptor&gt; In the above codes, when the filtered attribute is set to true, it will replace the placeholders(eg. $package, etc.) you have set in the template files with the parameters when executing mvn archetype:generate to generate projects. And when the packaged attribute is set to true, it will move the generated file to corresponding packages. To test the archetype resources, there is a archetype.properties and a goal.txt file prepared in the src/test/resources/projects/it-basic. In the integration-test phase, it will generate a test project using archetype resources and replace the placeholders using the properties defined in the archetype.properties and execute goals in the goal.txt against the generated project. I created a Github Actions workflow to verify the generated projects. Publishing to Maven Central Repository Note, the steps of publishing your packages to the Maven Central repository is a little tedious, please be patient. Once you have built the maven archetype project successfully, the next step is publishing it to Maven Central repository and make it public, there are some useful guides in Google results. I suggest you pick one or more from the following list and read it firstly. Publish JAR To Central Maven RepositoryHow to Publish Your Artifacts to Maven CentralCreate your own Maven Archetype in 5 simple steps Register an account of the Sonatype issue tracker.File a new issue on Community Support to submit your request of publishing your artifact. Check my issue#OSSRH-66424 I created for hantsy/maven-archetype-jakartaee9 as an example.Follow the response of the issue, create a new empty repo(the name is the issue id) on Github for authentication requirement. eg. OSSRH-66424Generate GPG keys and send to key servers. Under Windows 10 system, you have to install GPG tools firstly. Simply run the following command to install gpg4win if you are using Chocolatey. choco install gpg4win Refresh the environment. refreshenv Then generate GPG keys. # gpg — full-gen-key gpg (GnuPG) 2.2.27; Copyright © 2021 g10 Code GmbH This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. Please select what kind of key you want: (1) RSA and RSA (default) (2) DSA and Elgamal (3) DSA (sign only) (4) RSA (sign only) (14) Existing key from card Your selection? 1 RSA keys may be between 1024 and 4096 bits long. What keysize do you want? (3072) Requested keysize is 3072 bits Please specify how long the key should be valid. 0 = key does not expire &lt;n&gt; = key expires in n days &lt;n&gt;w = key expires in n weeks &lt;n&gt;m = key expires in n months &lt;n&gt;y = key expires in n years Key is valid for? (0) Key does not expire at all Is this correct? (y/N) y GnuPG needs to construct a user ID to identify your key. Real name: Hantsy Bai Email address: hantsy@gmail.com Comment: You selected this USER-ID: “Hantsy Bai &lt;hantsy@gmail.com&gt;” Change (N)ame, ©omment, (E)mail or (O)kay/(Q)uit? O We need to generate a lot of random bytes. It is a good idea to perform some other action (type on the keyboard, move the mouse, utilize the disks) during the prime generation; this gives the random number generator a better chance to gain enough entropy. gpg: AllowSetForegroundWindow(9152) failed: Access is denied. We need to generate a lot of random bytes. It is a good idea to perform some other action (type on the keyboard, move the mouse, utilize the disks) during the prime generation; this gives the random number generator a better chance to gain enough entropy. gpg: C:/Users/hantsy/AppData/Roaming/gnupg/trustdb.gpg: trustdb created gpg: key E5D9B4272348ADAE marked as ultimately trusted gpg: directory ‘C:/Users/hantsy/AppData/Roaming/gnupg/openpgp-revocs.d’ created gpg: revocation certificate stored as ‘C:/Users/hantsy/AppData/Roaming/gnupg/openpgp-revocs.d\\03B4C55DDA964D942C756D79E5D9B4272348ADAE.rev’ public and secret key created and signed. pub rsa3072 2021–03–30 [SC] 03B4C55DDA964D942C756D79E5D9B4272348ADAE uid Hantsy Bai &lt;hantsy@gmail.com&gt; sub rsa3072 2021–03–30 [E] Send the keys to the public key servers. # gpg — send-keys 03B4C55DDA964D942C756D79E5D9B4272348ADAE gpg: sending key E5D9B4272348ADAE to hkps://hkps.pool.sks-keyservers.net 5. Follow the steps of Deploying to OSSRH with Apache Maven to publish your artifact. I skip the detailed steps here, please read the Synatype’s article carefully. 6. Then back to the issue#OSSRH-66424, comment and notify the moderator to publish your artifact to the Maven Central repository. In one or two hours, your artifact will be available on Maven Central Repository Search index page. Publishing to Github Package The Configuring Apache Maven for use with GitHub Packages page provides detailed steps to publish a package to Github Packages. Following the steps of Authenticating to Github Packages to set the Github authentication info in your ~/.m2/settings.xml file.Deploy to Github Packages. In our case, we have set the distributionManagement to use the Maven Central repository. Use the following command instead. mvn clean package deploy -DskipTests -DaltDeploymentRepository=github::https://maven.pkg.github.com/hantsy/maven-archetype-jakartaee9 By default, Github Packages does not allow anyone to access your repository without an authentication. After consulting from Github community, there is a solution to resolve this issue gracefully, it is possible to make your repository accessible to the public.Generate a Personal Access Token with packages:read scope.Run the following command to generate the repository config. # docker run ghcr.io/jcansdale/gpr encode &lt;your PAT&gt; A NuGet `nuget.config` file: &lt;packageSourceCredentials&gt; &lt;github&gt; &lt;add key=”Username” value=”PublicToken” /&gt; &lt;add key=”ClearTextPassword” value=”&amp;#48;28d0c8f723084e499eb87a6fe173b3af295d618&quot; /&gt; &lt;/github&gt; &lt;/packageSourceCredentials&gt; A Maven `pom.xml` file: &lt;repositories&gt; &lt;repository&gt; &lt;id&gt;github-public&lt;/id&gt; &lt;url&gt;https://public:&amp;#48;28d0c8f723084e499eb87a6fe173b3af295d618@maven.pkg.github.com/&lt;OWNER&gt;/*&lt;/url&gt; &lt;/repository&gt; &lt;/repositories&gt; An npm `.npmrc` file: @OWNER:registry=https://npm.pkg.github.com //npm.pkg.github.com/:_authToken=”\\u003028d0c8f723084e499eb87a6fe173b3af295d618&quot; As you see, now you can add the above repository to your Maven proxy server or global Maven settings(~/.m2/settings.xml) in your system. Check the source codes from my Github. &lt;hr&gt;&lt;p&gt;Building your own Maven archetype was originally published in ITNEXT on Medium, where people are continuing the conversation by highlighting and responding to this story.&lt;/p&gt;","headline":"Building your own Maven archetype","mainEntityOfPage":{"@type":"WebPage","@id":"/blog/2021/building-your-own-maven-archetype/"},"url":"/blog/2021/building-your-own-maven-archetype/"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body
  class="fixed-top-nav ">

  <!-- Header -->

  <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="/">
       <span class="font-weight-bold">Hantsy</span>   Bai
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item active">
            <a class="nav-link" href="/blog/">
              blog
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                projects
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                publications
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/service/">
                service
                
              </a>
          </li>
          
          
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


  <!-- Content -->

  <div class="container mt-5">
    

<div class="post">

  <header class="post-header">
    <h1 class="post-title">Building your own Maven archetype</h1>
    <p class="post-meta">April 6, 2021</p>
  </header>

  <article class="post-content">
    <p>Github is easy to share codes with others, for example I created <a href="https://github.com/hantsy/jakartaee9-starter-boilerplate">jakartaee9-starter-boilerplate</a> as a project template for Jakarta EE developers. For those who are familiar with Github, it is easy to start their new projects by forking or cloning this project directly. But obviously for a general Jakarta EE application, you do not need the configuraitons of all application severs, eg. Glassfish/Payara, WildFly, OpenLiberty, Apache TomEE, etc. For most of Java developers esp. Maven users, a simple and clean Maven archetype is still the preferred option to generate the new project skeleton, and you can add the required configuration back later.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*zDxsL3REyJ2m4UkfBNpcZQ.jpeg" /></figure><p>I had created some maven archetype like toys myself in the past years, but I never made them public through the Maven Central repository. In this post, I will replay the steps of creating the <a href="https://github.com/hantsy/maven-archetype-jakartaee9">Maven Archetype for Jakarta EE 9</a> and the followed steps of publishing it to the Maven Central repository and making it public to the world.</p><h4>A better formatted version is published on dev.to, <a href="https://dev.to/hantsy_26/building-your-own-maven-archetype-gm8">https://dev.to/hantsy_26/building-your-own-maven-archetype-gm8</a></h4><h3>Generating the archetype project skeleton</h3><p>Maven <strong>archetype</strong> is the Maven specific templates used to generate a new project in the Maven build system. Maven itself provides an official archetype (maven-archetype-archetype) for you to build your own Maven archetype.</p><p>The <a href="https://maven.apache.org/guides/introduction/introduction-to-archetypes.html">official archetype introduction page</a> lists all official archetypes.</p><p>Run the following command to generate the archetype project in an interactive mode.</p><pre>mvn archetype:generate</pre><p>When you hit down the <em>Enter</em> key, it will take some seconds to list all available archetypes. Every archetype is attached to a number.</p><p>Type the number of maven-archetype-archetype , then it will ask you to fill groupId, archetypeId, package and version of your project. After all fields are filled as expected, it will generate the project in seconds.</p><p>Alternatively, you can generate the project in a single command aka the batch mode.</p><pre>mvn archetype:generate -B \<br>-DarchetypeGroupId=org.apache.maven.archetypes \<br>-DarchetypeArtifactId=maven-archetype-archetype \<br>-DarchetypeVersion=1.4 \<br>-DgroupId=io.github.hantsy \<br>-DartifactId=maven-archetype-jakartaee9 \<br>-Dversion=1.0-SNAPSHOT</pre><p>Note here we use the -B parameter in the command line to skip the interactive questionnaire steps and run the command in <strong>batch</strong> mode.</p><p>More info about Maven archetype and maven-archetype-plugin, please check <a href="http://maven.apache.org/archetype/">Maven Archetype</a>.</p><h3>Exploring the project structure</h3><p>Import the project into your IDEs, such as Apache NetBeans, IntelliJ IDEA, etc.</p><p>You will see the following project file structure.</p><pre>├── pom.xml<br>└── src<br>    ├── main<br>    │   └── resources<br>    │       ├── archetype-resources<br>    │       │   ├── pom.xml<br>    │       │   └── src<br>    │       │       ├── main<br>    │       │       │   └── java<br>    │       │       │       └── App.java<br>    │       │       └── test<br>    │       │           └── java<br>    │       │               └── AppTest.java<br>    │       └── META-INF<br>    │           └── maven<br>    │               └── archetype-metadata.xml<br>    └── test<br>        └── resources<br>            └── projects<br>                └── it-basic<br>                    ├── archetype.properties<br>                    └── goal.txt</pre><p>The structure is similar to a general Maven project, there are some difference.</p><ol><li>The <em>src/main/resources/archetype-resources</em> folder stores all template resources used to generate projects from this archetype.</li><li>The <em>src/main/resources/META-INF/maven-archetype-metadata.xml</em> is the archetype description file, including the properties, file sets etc.</li><li>The <em>src/test/resources/projects</em> includes resources to test this archetype, including the properties applied to generate new projects and the goal run in the host integration-test phase.</li></ol><h3>Preparing the archetype resources</h3><p>To simplify the work, I reuse the sample codes from <a href="https://github.com/hantsy/jakartaee9-starter-boilerplate">jakartaee9-starter-boilerplate</a>.</p><ol><li>Copy GreetingMessage, GreetingService, GreetingService and JaxrsActivator to the <em>src/main/resources/archetype-resources/src/main/java</em> folder. Change the package declaration to the following.</li></ol><pre>package $package; <br>…</pre><p>2. Similar to the last step, copy the GreetingResourceTest and GreetingServiceTest to the <em>src/main/resources/archetype-resources/src/test/java</em> folder. Remember changing the package declaration.</p><p>3. Add empty beans.xmlfile to the <em>src/main/resources/archetype-resources/src/main/resources/META-INF/</em> folder.</p><pre>&lt;beans xmlns=”https://jakarta.ee/xml/ns/jakartaee&quot; xmlns:xsi=”http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=”https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/beans_3_0.xsd&quot; version=”3.0&quot;&gt; &lt;/beans&gt;</pre><p>4. Add a simple arquillian.xml to the <em>src/main/resources/archetype-resources/src/test/resources</em> folder.</p><pre>&lt;arquillian xmlns:xsi=”http://www.w3.org/2001/XMLSchema-instance&quot; xmlns=”http://jboss.org/schema/arquillian&quot; xsi:schemaLocation=”http://jboss.org/schema/arquillian http://jboss.org/schema/arquillian/arquillian_1_0.xsd&quot;&gt; &lt;defaultProtocol type=”Servlet 5.0&quot;/&gt; </pre><pre>&lt;engine&gt; <br>  &lt;property name=”deploymentExportPath”&gt;target/&lt;/property&gt; &lt;/engine&gt; <br>&lt;container qualifier=”glassfish” default=”true”&gt; <br>&lt;configuration&gt; <br>  &lt;property name=”adminHost”&gt;localhost&lt;/property&gt;<br>  &lt;property name=”adminPort”&gt;4848&lt;/property&gt; <br>  &lt;property name=”adminUser”&gt;admin&lt;/property&gt; &lt;! — if https is enabled via `asadmin enable-secure-admin` on a remote server →<br>  &lt;! — &lt;property name=”adminHttps”&gt;true&lt;/property&gt; →<br>  &lt;! — if admin password is changed via `asadmin change-admin-password` → <br>  &lt;! — &lt;property name=”adminPassword”&gt;adminadmin&lt;/property&gt; →<br>  &lt;! — default is empty → &lt;property name=”adminPassword”&gt;&lt;/property&gt; <br>&lt;/configuration&gt; <br>&lt;/container&gt; <br>&lt;/arquillian&gt;</pre><p>5. Change the pom.xml template (<em>src/main/resources/archetype-resources/pom.xml</em>) to the following.</p><pre>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;<br>  xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;<br>  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;<br>  &lt;groupId&gt;${groupId}&lt;/groupId&gt;<br>  &lt;artifactId&gt;${artifactId}&lt;/artifactId&gt;<br>  &lt;version&gt;${version}&lt;/version&gt;<br>  &lt;packaging&gt;war&lt;/packaging&gt;<br><br>  &lt;name&gt;${artifactId}&lt;/name&gt;<br>  &lt;description&gt;A Jakarta EE starter boilerplate for Jakarta EE 9&lt;/description&gt;<br>  &lt;properties&gt;<br>    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;<br>    &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;<br>    &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;<br>    &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;<br><br>    &lt;!-- Official Maven Plugins --&gt;<br>    &lt;maven-compiler-plugin.version&gt;3.8.1&lt;/maven-compiler-plugin.version&gt;<br>    &lt;maven-war-plugin.version&gt;3.3.1&lt;/maven-war-plugin.version&gt;<br>    &lt;maven-dependency-plugin.version&gt;3.1.2&lt;/maven-dependency-plugin.version&gt;<br>    &lt;maven-surefire-plugin.version&gt;3.0.0-M5&lt;/maven-surefire-plugin.version&gt;<br>    &lt;maven-failsafe-plugin.version&gt;3.0.0-M5&lt;/maven-failsafe-plugin.version&gt;<br>    &lt;maven-surefire-report-plugin.version&gt;3.0.0-M5&lt;/maven-surefire-report-plugin.version&gt;<br><br>    &lt;!-- Cargo maven plugin --&gt;<br>    &lt;!-- Since 1.9.0, cargo-maven3-plugin is the default for cargo prefix. --&gt;<br>    &lt;cargo-maven3-plugin.version&gt;1.9.0&lt;/cargo-maven3-plugin.version&gt;<br><br>    &lt;!-- Jakarta EE API --&gt;<br>    &lt;jakartaee-api.version&gt;9.0.0&lt;/jakartaee-api.version&gt;<br><br>    &lt;!-- Arquillian BOM --&gt;<br>    &lt;arquillian-bom.version&gt;1.7.0.Alpha9&lt;/arquillian-bom.version&gt;<br>    &lt;junit-jupiter.version&gt;5.7.1&lt;/junit-jupiter.version&gt;<br><br>    &lt;!-- Glassfish server --&gt;<br>    &lt;glassfish.version&gt;6.0.0&lt;/glassfish.version&gt;<br>    &lt;arquillian-glassfish6.version&gt;1.0.0.Alpha1&lt;/arquillian-glassfish6.version&gt;<br>    &lt;jersey.version&gt;3.0.1&lt;/jersey.version&gt;<br><br>    &lt;!-- by default skip tests --&gt;<br>    &lt;skipTests&gt;true&lt;/skipTests&gt;<br>  &lt;/properties&gt;<br><br>  &lt;dependencyManagement&gt;<br>    &lt;dependencies&gt;<br>      &lt;dependency&gt;<br>        &lt;groupId&gt;jakarta.platform&lt;/groupId&gt;<br>        &lt;artifactId&gt;jakarta.jakartaee-api&lt;/artifactId&gt;<br>        &lt;version&gt;${jakartaee-api.version}&lt;/version&gt;<br>        &lt;scope&gt;provided&lt;/scope&gt;<br>      &lt;/dependency&gt;<br>      &lt;dependency&gt;<br>        &lt;groupId&gt;org.jboss.arquillian&lt;/groupId&gt;<br>        &lt;artifactId&gt;arquillian-bom&lt;/artifactId&gt;<br>        &lt;version&gt;${arquillian-bom.version}&lt;/version&gt;<br>        &lt;scope&gt;import&lt;/scope&gt;<br>        &lt;type&gt;pom&lt;/type&gt;<br>      &lt;/dependency&gt;<br>      &lt;dependency&gt;<br>        &lt;groupId&gt;org.junit&lt;/groupId&gt;<br>        &lt;artifactId&gt;junit-bom&lt;/artifactId&gt;<br>        &lt;version&gt;${junit-jupiter.version}&lt;/version&gt;<br>        &lt;type&gt;pom&lt;/type&gt;<br>        &lt;scope&gt;import&lt;/scope&gt;<br>      &lt;/dependency&gt;<br>    &lt;/dependencies&gt;<br>  &lt;/dependencyManagement&gt;<br><br>  &lt;dependencies&gt;<br>    &lt;dependency&gt;<br>      &lt;groupId&gt;jakarta.platform&lt;/groupId&gt;<br>      &lt;artifactId&gt;jakarta.jakartaee-api&lt;/artifactId&gt;<br>    &lt;/dependency&gt;<br>    &lt;dependency&gt;<br>      &lt;groupId&gt;org.jboss.arquillian.junit5&lt;/groupId&gt;<br>      &lt;artifactId&gt;arquillian-junit5-container&lt;/artifactId&gt;<br>      &lt;scope&gt;test&lt;/scope&gt;<br>    &lt;/dependency&gt;<br>    &lt;!-- see: https://github.com/arquillian/arquillian-core/issues/248 --&gt;<br>    &lt;!-- and https://github.com/arquillian/arquillian-core/pull/246/files --&gt;<br>    &lt;dependency&gt;<br>      &lt;groupId&gt;org.jboss.arquillian.protocol&lt;/groupId&gt;<br>      &lt;artifactId&gt;arquillian-protocol-servlet-jakarta&lt;/artifactId&gt;<br>      &lt;scope&gt;test&lt;/scope&gt;<br>    &lt;/dependency&gt;<br>    &lt;dependency&gt;<br>      &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;<br>      &lt;artifactId&gt;junit-jupiter&lt;/artifactId&gt;<br>      &lt;scope&gt;test&lt;/scope&gt;<br>    &lt;/dependency&gt;<br>  &lt;/dependencies&gt;<br><br>  &lt;build&gt;<br>    &lt;finalName&gt;${project.artifactId}&lt;/finalName&gt;<br>    &lt;pluginManagement&gt;<br>      &lt;plugins&gt;<br>        &lt;plugin&gt;<br>          &lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt;<br>          &lt;artifactId&gt;cargo-maven3-plugin&lt;/artifactId&gt;<br>          &lt;version&gt;${cargo-maven3-plugin.version}&lt;/version&gt;<br>        &lt;/plugin&gt;<br>      &lt;/plugins&gt;<br>    &lt;/pluginManagement&gt;<br>    &lt;plugins&gt;<br>      &lt;plugin&gt;<br>        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<br>        &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;<br>        &lt;version&gt;${maven-compiler-plugin.version}&lt;/version&gt;<br>      &lt;/plugin&gt;<br>      &lt;plugin&gt;<br>        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<br>        &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;<br>        &lt;version&gt;${maven-war-plugin.version}&lt;/version&gt;<br>      &lt;/plugin&gt;<br>    &lt;/plugins&gt;<br>  &lt;/build&gt;<br>  &lt;profiles&gt;<br>    &lt;profile&gt;<br>      &lt;id&gt;glassfish&lt;/id&gt;<br>      &lt;activation&gt;<br>        &lt;activeByDefault&gt;true&lt;/activeByDefault&gt;<br>      &lt;/activation&gt;<br>      &lt;build&gt;<br>        &lt;plugins&gt;<br>          &lt;plugin&gt;<br>            &lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt;<br>            &lt;artifactId&gt;cargo-maven3-plugin&lt;/artifactId&gt;<br>            &lt;configuration&gt;<br>              &lt;container&gt;<br>                &lt;containerId&gt;glassfish6x&lt;/containerId&gt;<br>                &lt;artifactInstaller&gt;<br>                  &lt;groupId&gt;org.glassfish.main.distributions&lt;/groupId&gt;<br>                  &lt;artifactId&gt;glassfish&lt;/artifactId&gt;<br>                  &lt;version&gt;${glassfish.version}&lt;/version&gt;<br>                &lt;/artifactInstaller&gt;<br>              &lt;/container&gt;<br>              &lt;configuration&gt;<br>                &lt;!-- the configuration used to deploy --&gt;<br>                &lt;home&gt;${project.build.directory}/glassfish6x-home&lt;/home&gt;<br>                &lt;properties&gt;<br>                  &lt;cargo.remote.password&gt;&lt;/cargo.remote.password&gt;<br>                &lt;/properties&gt;<br>              &lt;/configuration&gt;<br>            &lt;/configuration&gt;<br>          &lt;/plugin&gt;<br>        &lt;/plugins&gt;<br>      &lt;/build&gt;<br><br>      &lt;dependencies&gt;<br>        &lt;!-- Jersey --&gt;<br>        &lt;dependency&gt;<br>          &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt;<br>          &lt;artifactId&gt;jersey-media-sse&lt;/artifactId&gt;<br>          &lt;version&gt;${jersey.version}&lt;/version&gt;<br>          &lt;scope&gt;test&lt;/scope&gt;<br>        &lt;/dependency&gt;<br>        &lt;dependency&gt;<br>          &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt;<br>          &lt;artifactId&gt;jersey-media-json-binding&lt;/artifactId&gt;<br>          &lt;version&gt;${jersey.version}&lt;/version&gt;<br>          &lt;scope&gt;test&lt;/scope&gt;<br>        &lt;/dependency&gt;<br>        &lt;dependency&gt;<br>          &lt;groupId&gt;org.glassfish.jersey.inject&lt;/groupId&gt;<br>          &lt;artifactId&gt;jersey-hk2&lt;/artifactId&gt;<br>          &lt;version&gt;${jersey.version}&lt;/version&gt;<br>          &lt;scope&gt;test&lt;/scope&gt;<br>        &lt;/dependency&gt;<br>        &lt;dependency&gt;<br>          &lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt;<br>          &lt;artifactId&gt;jersey-client&lt;/artifactId&gt;<br>          &lt;version&gt;${jersey.version}&lt;/version&gt;<br>          &lt;scope&gt;test&lt;/scope&gt;<br>        &lt;/dependency&gt;<br>        &lt;dependency&gt;<br>          &lt;groupId&gt;org.jboss.arquillian.container&lt;/groupId&gt;<br>          &lt;artifactId&gt;arquillian-glassfish-remote-6&lt;/artifactId&gt;<br>          &lt;version&gt;${arquillian-glassfish6.version}&lt;/version&gt;<br>          &lt;scope&gt;test&lt;/scope&gt;<br>        &lt;/dependency&gt;<br>      &lt;/dependencies&gt;<br><br>    &lt;/profile&gt;<br>  &lt;/profiles&gt;<br>&lt;/project&gt; </pre><p>Note, the value of groupId, artifactId and version elements in this xml refers to a placeholder which can be intercepted in the generating stage.</p><p>6. Change the archetype descriptor (<em>src/main/resources/META-INF/maven/archetype-metadata.xml</em>) to the following.</p><pre>&lt;archetype-descriptor xmlns=”http://maven.apache.org/plugins/maven-archetype-plugin/archetype-descriptor/1.0.0&quot; xmlns:xsi=”http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=”http://maven.apache.org/plugins/maven-archetype-plugin/archetype-descriptor/1.0.0 http://maven.apache.org/xsd/archetype-descriptor-1.0.0.xsd&quot; name=”${artifactId}”&gt; &lt;fileSets&gt; <br>&lt;fileSet filtered=”true” packaged=”true”&gt;<br> &lt;directory&gt;src/main/java&lt;/directory&gt; <br>&lt;/fileSet&gt; <br>&lt;fileSet&gt; &lt;directory&gt;src/main/resources&lt;/directory&gt; <br>&lt;/fileSet&gt; <br>&lt;fileSet filtered=”true” packaged=”true”&gt; <br>&lt;directory&gt;src/test/java&lt;/directory&gt; <br>&lt;/fileSet&gt; <br>&lt;fileSet&gt; <br>&lt;directory&gt;src/test/resources&lt;/directory&gt; <br>&lt;/fileSet&gt; <br>&lt;/fileSets&gt; <br>&lt;/archetype-descriptor&gt;</pre><p>In the above codes, when the filtered attribute is set to true, it will replace the placeholders(eg. $package, etc.) you have set in the template files with the parameters when executing mvn archetype:generate to generate projects. And when the packaged attribute is set to true, it will move the generated file to corresponding packages.</p><p>To test the archetype resources, there is a <em>archetype.properties</em> and a <em>goal.txt</em> file prepared in the <em>src/test/resources/projects/it-basic</em>. In the <em>integration-test</em> phase, it will generate a test project using archetype resources and replace the placeholders using the properties defined in the <em>archetype.properties</em> and execute goals in the goal.txt against the generated project.</p><p>I created a <a href="https://github.com/hantsy/maven-archetype-jakartaee9/blob/master/.github/workflows/it-with-arq-glassfish-remote.yml">Github Actions workflow</a> to verify the generated projects.</p><h3>Publishing to Maven Central Repository</h3><blockquote><em>Note, the steps of publishing your packages to the Maven Central repository is a little tedious, please be patient.</em></blockquote><p>Once you have built the maven archetype project successfully, the next step is publishing it to Maven Central repository and make it public, there are some useful guides in Google results. I suggest you pick one or more from the following list and read it firstly.</p><ul><li><a href="http://tutorials.jenkov.com/maven/publish-to-central-maven-repository.html">Publish JAR To Central Maven Repository</a></li><li><a href="https://dzone.com/articles/publish-your-artifacts-to-maven-central">How to Publish Your Artifacts to Maven Central</a></li><li><a href="https://rieckpil.de/create-your-own-maven-archetype-in-5-simple-steps/">Create your own Maven Archetype in 5 simple steps</a></li></ul><ol><li>Register an account of the <a href="https://issues.sonatype.org">Sonatype issue tracker</a>.</li><li>File a new issue on <a href="https://issues.sonatype.org/projects/OSSRH">Community Support</a> to submit your request of publishing your artifact. Check <a href="https://issues.sonatype.org/browse/OSSRH-66424">my issue#OSSRH-66424</a> I created for <a href="https://github.com/hantsy/maven-archetype-jakartaee9">hantsy/maven-archetype-jakartaee9</a> as an example.</li><li>Follow the response of the issue, create a new empty repo(the name is the issue id) on Github for authentication requirement. eg. <a href="https://github.com/hantsy/OSSRH-66424">OSSRH-66424</a></li><li>Generate GPG keys and send to key servers.</li></ol><p>Under Windows 10 system, you have to install GPG tools firstly. Simply run the following command to install gpg4win if you are using <a href="https://chocolatey.org/">Chocolatey</a>.</p><pre>choco install gpg4win</pre><p>Refresh the environment.</p><pre>refreshenv</pre><p>Then generate GPG keys.</p><pre># gpg — full-gen-key <br>gpg (GnuPG) 2.2.27; Copyright © 2021 g10 Code GmbH This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. <br>Please select what kind of key you want: <br>(1) RSA and RSA (default) <br>(2) DSA and Elgamal <br>(3) DSA (sign only) <br>(4) RSA (sign only) <br>(14) Existing key from card Your selection? 1<br> RSA keys may be between 1024 and 4096 bits long. <br>What keysize do you want? (3072) <br>Requested keysize is 3072 bits Please specify how long the key should be valid. 0 = key does not expire &lt;n&gt; = key expires in n days &lt;n&gt;w = key expires in n weeks &lt;n&gt;m = key expires in n months &lt;n&gt;y = key expires in n years Key is valid for? (0) Key does not expire at all Is this correct? (y/N) y <br>GnuPG needs to construct a user ID to identify your key. <br>Real name: Hantsy Bai <br>Email address: hantsy@gmail.com <br>Comment: <br>You selected this USER-ID: “Hantsy Bai &lt;hantsy@gmail.com&gt;” </pre><pre>Change (N)ame, ©omment, (E)mail or (O)kay/(Q)uit? O </pre><pre>We need to generate a lot of random bytes. It is a good idea to perform some other action (type on the keyboard, move the mouse, utilize the disks) during the prime generation; this gives the random number generator a better chance to gain enough entropy. gpg: AllowSetForegroundWindow(9152) failed: Access is denied. </pre><pre>We need to generate a lot of random bytes. It is a good idea to perform some other action (type on the keyboard, move the mouse, utilize the disks) during the prime generation; this gives the random number generator a better chance to gain enough entropy. gpg: C:/Users/hantsy/AppData/Roaming/gnupg/trustdb.gpg: trustdb created gpg: key E5D9B4272348ADAE marked as ultimately trusted gpg: directory ‘C:/Users/hantsy/AppData/Roaming/gnupg/openpgp-revocs.d’ created gpg: revocation certificate stored as ‘C:/Users/hantsy/AppData/Roaming/gnupg/openpgp-revocs.d\03B4C55DDA964D942C756D79E5D9B4272348ADAE.rev’ public and secret key created and signed. </pre><pre>pub rsa3072 2021–03–30 [SC] 03B4C55DDA964D942C756D79E5D9B4272348ADAE uid Hantsy Bai &lt;hantsy@gmail.com&gt; <br>sub rsa3072 2021–03–30 [E]</pre><p>Send the keys to the public key servers.</p><pre># gpg — send-keys 03B4C55DDA964D942C756D79E5D9B4272348ADAE gpg: sending key E5D9B4272348ADAE to hkps://hkps.pool.sks-keyservers.net</pre><p>5. Follow the steps of <a href="https://central.sonatype.org/pages/apache-maven.html">Deploying to OSSRH with Apache Maven</a> to publish your artifact.</p><blockquote><em>I skip the detailed steps here, please read the Synatype’s </em><a href="https://central.sonatype.org/pages/apache-maven.html"><em>article</em></a><em> carefully.</em></blockquote><p>6. Then back to the <a href="https://issues.sonatype.org/browse/OSSRH-66424">issue#OSSRH-66424</a>, comment and notify the moderator to publish your artifact to the Maven Central repository. In one or two hours, your artifact will be available on <a href="https://search.maven.org/search?q=io.github.hantsy">Maven Central Repository Search index page</a>.</p><h3>Publishing to Github Package</h3><p>The <a href="https://docs.github.com/en/packages/guides/configuring-apache-maven-for-use-with-github-packages">Configuring Apache Maven for use with GitHub Packages</a> page provides detailed steps to <a href="https://docs.github.com/en/packages/guides/configuring-apache-maven-for-use-with-github-packages#publishing-a-package">publish a package</a> to Github Packages.</p><ol><li>Following the steps of <a href="https://docs.github.com/en/packages/guides/configuring-apache-maven-for-use-with-github-packages#authenticating-to-github-packages">Authenticating to Github Packages</a> to set the Github authentication info in your <em>~/.m2/settings.xml</em> file.</li><li>Deploy to Github Packages.</li></ol><ul><li>In our case, we have set the distributionManagement to use the Maven Central repository. Use the following command instead.</li></ul><pre>mvn clean package deploy -DskipTests -DaltDeploymentRepository=github::https://maven.pkg.github.com/hantsy/maven-archetype-jakartaee9</pre><ul><li>By default, Github Packages does not allow anyone to access your repository without an authentication. After <a href="https://github.community/t/how-to-make-github-packages-to-the-public/171321">consulting from Github community</a>, there is a solution to resolve this issue gracefully, it is possible to make your repository accessible to the public.</li><li>Generate a Personal Access Token with packages:read scope.</li><li>Run the following command to generate the repository config.</li></ul><pre># docker run ghcr.io/jcansdale/gpr encode &lt;your PAT&gt;</pre><pre>A NuGet `nuget.config` file: <br>&lt;packageSourceCredentials&gt; <br>&lt;github&gt; <br>&lt;add key=”Username” value=”PublicToken” /&gt; <br>&lt;add key=”ClearTextPassword” value=”&amp;#48;28d0c8f723084e499eb87a6fe173b3af295d618&quot; /&gt; <br>&lt;/github&gt; <br>&lt;/packageSourceCredentials&gt; </pre><pre>A Maven `pom.xml` file:<br> &lt;repositories&gt; <br>&lt;repository&gt; <br>&lt;id&gt;github-public&lt;/id&gt; &lt;url&gt;https://public:&amp;#48;28d0c8f723084e499eb87a6fe173b3af295d618@maven.pkg.github.com/&lt;OWNER&gt;/*&lt;/url&gt; <br>&lt;/repository&gt; <br>&lt;/repositories&gt; </pre><pre>An npm `.npmrc` file: <br>@OWNER:registry=https://npm.pkg.github.com //npm.pkg.github.com/:_authToken=”\u003028d0c8f723084e499eb87a6fe173b3af295d618&quot;</pre><ul><li>As you see, now you can add the above repository to your Maven proxy server or global Maven settings(<em>~/.m2/settings.xml</em>) in your system.</li></ul><p>Check the <a href="https://github.com/hantsy/maven-archetype-jakartaee9">source codes from my Github</a>.</p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=fa7b9d646efd" width="1" height="1" alt=""><hr><p><a href="https://itnext.io/building-your-own-maven-archetype-fa7b9d646efd">Building your own Maven archetype</a> was originally published in <a href="https://itnext.io">ITNEXT</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>

  </article>

  

</div>

  </div>

  <!-- Footer -->

  
<footer class="fixed-bottom">
  <div class="container mt-0">
    &copy; Copyright 2022 Hantsy  Bai.
    <span class="mr-auto"></span>
    Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme.

    
    

  </div>
</footer>



</body>

<!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>


<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>





<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>


</html>
