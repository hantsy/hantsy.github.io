---
layout: post
title: Deploying Jakarta EE 9 applications to Glassfish v6 using Cargo maven plugin
---

<p>From the Jakarta EE mail subscription, I think Jakarta EE 9 is ready for the public and the official announcement will come soon in a few days.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*XZgar-TMaqJ9r-ovXsLz_A.png" /></figure><p>In the former <a href="https://github.com/hantsy/jakartaee8-starter">Jakarta EE 8 starter boilerplate</a> , I have described <a href="https://github.com/hantsy/jakartaee8-starter/blob/master/docs/03run-glassfish-mvn.md">how to deploy a Jakarta EE 8 application on Glassfish v5</a>, in this post, I will update it and try to deploy the Jakarta EE 9 sample application to a Glassfish v6 application server.</p><h3>Prerequisites</h3><p>Make sure you have installed the following software.</p><ul><li>Java 8, yes, Glassfish v6 still only supports Java 8, the next 6.1 will focus on Java 11 support. Oracle JDK 8 or AdoptOpenJDK 8 is recommended.</li><li>Download and install <a href="https://github.com/eclipse-ee4j/glassfish/releases">Glassfish v6</a> , this is required when you are deploying the applications via the <strong>existing</strong> and remote <strong>runtime</strong> configuration.</li><li>Download and install <a href="http://maven.apache.org/">Apache Maven</a> .</li><li>Get to know the basic of <a href="https://codehaus-cargo.github.io/">Cargo maven plugin</a>.</li></ul><blockquote><em>In this post we still use the Cargo </em><em>glassfish5x container to perform the deployment. Cargo will include a new </em><em>glassfish6x container in 1.8.3 for Glassfish v6.</em></blockquote><h3>Deploying the applications</h3><p>Clone the <a href="https://github.com/hantsy/jakartaee9-starter-boilerplate">Jakarta EE9 starter boilerplate</a> repository into your local disk.</p><p>Open a terminal and switch to the project root folder, execute the following command to build and deploy this Jakarta EE 9 application to Glassfish v6 .</p><pre>mvn clean verify org.codehaus.cargo:cargo-maven2-plugin:1.8.2:run <br>-Dcargo.maven.containerId=glassfish5x   <br>-Dcargo.maven.containerUrl=https://download.eclipse.org/ee4j/glassfish/glassfish-6.0.0-RC2.zip  <br>-Dcargo.servlet.port=8080</pre><p>This command will use Maven to build the project, and then call cargo maven plugin to download a copy of Glassfish v6 from the the specified URL, and then try to prepare a new domain configuration for the application deployment, then start the new created domain, and final deploy the deployable file( target\jakartaee9-starter-boilerplate.war).</p><p>You will see info similar to the following when the deployment is successful.</p><pre>[INFO] --- cargo-maven2-plugin:1.8.2:run (default-cli) @ jakartaee9-starter-boilerplate ---<br>[INFO] [en2.ContainerRunMojo] Resolved container artifact org.codehaus.cargo:cargo-core-container-glassfish:jar:1.8.2 for container glassfish5x<br>[INFO] [talledLocalContainer] Parsed GlassFish version = [6.0.0.RC2]<br>[INFO] [talledLocalContainer] GlassFish 6.0.0.RC2 starting...<br>[INFO] [talledLocalContainer] Using port 4848 for Admin.<br>[INFO] [talledLocalContainer] Using port 8080 for HTTP Instance.<br>[INFO] [talledLocalContainer] Using port 7676 for JMS.<br>[INFO] [talledLocalContainer] Using port 3700 for IIOP.<br>[INFO] [talledLocalContainer] Using port 8181 for HTTP_SSL.<br>[INFO] [talledLocalContainer] Using port 3820 for IIOP_SSL.<br>[INFO] [talledLocalContainer] Using port 3920 for IIOP_MUTUALAUTH.<br>[INFO] [talledLocalContainer] Using port 8686 for JMX_ADMIN.<br>[INFO] [talledLocalContainer] Using port 6666 for OSGI_SHELL.<br>[INFO] [talledLocalContainer] Using port 9009 for JAVA_DEBUGGER.<br>[INFO] [talledLocalContainer] Distinguished Name of the self-signed X.509 Server Certificate is:<br>[INFO] [talledLocalContainer] [CN=hantsy-t540p,OU=GlassFish,O=Eclipse.org Foundation Inc,L=Ottawa,ST=Ontario,C=CA]<br>[INFO] [talledLocalContainer] Distinguished Name of the self-signed X.509 Server Certificate is:<br>[INFO] [talledLocalContainer] [CN=hantsy-t540p-instance,OU=GlassFish,O=Eclipse.org Foundation Inc,L=Ottawa,ST=Ontario,C=CA]<br>[INFO] [talledLocalContainer] Domain cargo-domain created.<br>[INFO] [talledLocalContainer] Domain cargo-domain admin port is 4848.<br>[INFO] [talledLocalContainer] Domain cargo-domain admin user is &quot;admin&quot;.<br>[INFO] [talledLocalContainer] Command create-domain executed successfully.<br>[INFO] [talledLocalContainer] Attempting to start cargo-domain.... Please look at the server log for more details.....<br>[INFO] [talledLocalContainer] remote failure: The jdbc resource [ jdbc/__default ] cannot be deleted as it is required to be configured in the system.<br>[INFO] [talledLocalContainer] Command delete-jdbc-resource failed.<br>[INFO] [talledLocalContainer] JDBC Connection pool DerbyPool deleted successfully<br>[INFO] [talledLocalContainer] Command delete-jdbc-connection-pool executed successfully.<br>[INFO] [talledLocalContainer] Application deployed with name jakartaee9-starter-boilerplate.<br>[INFO] [talledLocalContainer] Command deploy executed successfully.<br>[INFO] [talledLocalContainer] Application deployed with name cargocpc.<br>[INFO] [talledLocalContainer] Command deploy executed successfully.<br>[INFO] [talledLocalContainer] GlassFish 6.0.0.RC2 started on port [8080]<br>[INFO] Press Ctrl-C to stop the container...</pre><p>The above command is equivalent to the following config in the project <em>pom.xml</em> file.</p><pre>&lt;properties&gt;<br>	&lt;cargo.servlet.port&gt;8080&lt;/cargo.servlet.port&gt;<br>	&lt;cargo.zipUrlInstaller.downloadDir&gt;${project.build.directory}/../installs<br>	&lt;/cargo.zipUrlInstaller.downloadDir&gt;<br>&lt;/properties&gt;</pre><pre>&lt;build&gt;<br>	&lt;plugins&gt;<br>		&lt;plugin&gt;<br>			&lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt;<br>			&lt;artifactId&gt;cargo-maven2-plugin&lt;/artifactId&gt;<br>			&lt;configuration&gt;<br>				&lt;container&gt;<br>					&lt;containerId&gt;glassfish5x&lt;/containerId&gt;<br>					&lt;zipUrlInstaller&gt;<br>						&lt;url&gt;https://download.eclipse.org/ee4j/glassfish/glassfish-6.0.0-RC2.zip&lt;/url&gt;<br>						&lt;downloadDir&gt;${cargo.zipUrlInstaller.downloadDir}&lt;/downloadDir&gt;<br>					&lt;/zipUrlInstaller&gt;<br>				&lt;/container&gt;<br>				&lt;configuration&gt;<br>					&lt;home&gt;${project.build.directory}/glassfish6x-home&lt;/home&gt;<br>					&lt;properties&gt;<br>						&lt;cargo.servlet.port&gt;${cargo.servlet.port}&lt;/cargo.servlet.port&gt;<br>					&lt;/properties&gt;<br>				&lt;/configuration&gt;<br>			&lt;/configuration&gt;<br>		&lt;/plugin&gt;<br>	&lt;/plugins&gt;<br>&lt;/build&gt;</pre><p>You can run the following command instead with the above configuration.</p><pre>mvn clean verify cargo:run</pre><p>Here we use the run goal, it will keep the application server running until we sending a CTRL+C command to stop it.</p><p>If you have prepared a copy of Glassfish v6, you can reuse the <strong>existing</strong> Glassfish and domain configuration.</p><pre>&lt;properties&gt;<br>	&lt;glassfish.home&gt;[ The existing glassfish6 dir]&lt;/glassfish.home&gt;<br>	&lt;glassfish.domainDir&gt;${glassfish.home}/glassfish/domains&lt;/glassfish.domainDir&gt;<br>	&lt;glassfish.domainName&gt;domain1&lt;/glassfish.domainName&gt;<br>&lt;/properties&gt;<br>&lt;build&gt;<br>	&lt;plugins&gt;<br>		&lt;plugin&gt;<br>			&lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt;<br>			&lt;artifactId&gt;cargo-maven2-plugin&lt;/artifactId&gt;<br>			&lt;configuration&gt;<br>				&lt;container&gt;<br>					&lt;containerId&gt;glassfish5x&lt;/containerId&gt;<br>					&lt;type&gt;installed&lt;/type&gt;<br>					&lt;home&gt;${glassfish.home}&lt;/home&gt;<br>				&lt;/container&gt;<br>				&lt;configuration&gt;<br>					&lt;type&gt;existing&lt;/type&gt;<br>					&lt;home&gt;${glassfish.domainDir}&lt;/home&gt;<br>					&lt;properties&gt;<br>						&lt;cargo.glassfish.domain.name&gt;${glassfish.domainName}&lt;/cargo.glassfish.domain.name&gt;<br>						&lt;cargo.remote.password&gt;&lt;/cargo.remote.password&gt;<br>					&lt;/properties&gt;<br>				&lt;/configuration&gt;<br>			&lt;/configuration&gt;<br>		&lt;/plugin&gt;<br>	&lt;/plugins&gt;<br>&lt;/build&gt;</pre><p>In the above codes, set the configuration type to <strong>existing</strong>, and specify the domain name to the default domain1, when run the following command it will reuse the existing domain1 to deploy the applications.</p><pre>mvn clean verify cargo:run</pre><p>If you want to deploy your applications to a running Glassfish v6 server(esp. it is running on a different machine), try to configure a <strong>runtime</strong> configuration and use a <strong>remote</strong> deployer to perform the deployment.</p><pre>&lt;plugin&gt;<br>	&lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt;<br>	&lt;artifactId&gt;cargo-maven2-plugin&lt;/artifactId&gt;<br>	&lt;configuration&gt;<br>		&lt;container&gt;<br>			&lt;containerId&gt;glassfish5x&lt;/containerId&gt;<br>			&lt;type&gt;remote&lt;/type&gt;<br>		&lt;/container&gt;<br>		&lt;configuration&gt;<br>			&lt;type&gt;runtime&lt;/type&gt;<br>			&lt;properties&gt;<br>				&lt;cargo.remote.username&gt;admin&lt;/cargo.remote.username&gt;<br>				&lt;cargo.remote.password&gt;&lt;/cargo.remote.password&gt;<br>				&lt;cargo.glassfish.admin.port&gt;4848&lt;/cargo.glassfish.admin.port&gt;<br>				&lt;cargo.hostname&gt;localhost&lt;/cargo.hostname&gt;<br>			&lt;/properties&gt;<br>		&lt;/configuration&gt;<br>	&lt;/configuration&gt;<br>	&lt;!-- provides JSR88 client API to deploy on Glassfish/Payara Server --&gt;<br>	&lt;!-- WARNING: deployment client is not available in Glassfish v6.0 --&gt;<br>	&lt;dependencies&gt;<br>		&lt;dependency&gt;<br>			&lt;groupId&gt;org.glassfish.main.deployment&lt;/groupId&gt;<br>			&lt;artifactId&gt;deployment-client&lt;/artifactId&gt;<br>			&lt;version&gt;5.1.0&lt;/version&gt;<br>			&lt;!--&lt;version&gt;${glassfish.version}&lt;/version&gt;--&gt;<br>		&lt;/dependency&gt;<br>	&lt;/dependencies&gt;<br>&lt;/plugin&gt;</pre><p>In the above configuration:</p><ul><li>cargo.hostname is the target server you want to deploy to</li><li>cargo.remote.username and cargo.remote.password is administrator account used to deploy</li><li>The remote deployer depends on a deployment-client archetype, here we use the version 5.1.0, there is no new version for Glassfish v6, and JSR 88 spec is removed in Jakarta EE 9.</li></ul><p>For a remote container, you can not control the start and stop lifecycle as the former configurations, use deploy and undeploy goal to perform the deploy and undeploy tasks.</p><pre># deploy applications<br>mvn clean verify cargo:deploy</pre><pre># undeploy<br>mvn cargo:undeploy</pre><p>When the application is deployed successfully, use curl to verify if the deployed application is running.</p><pre>curl <a href="http://localhost:8080/jakartaee9-starter-boilerplate/api/greeting/Hantsy">http://localhost:8080/jakartaee9-starter-boilerplate/api/greeting/Hantsy</a><br>{&quot;message&quot;:&quot;Say Hello to Hantsy at 2020-11-14T15:56:10.099&quot;}</pre><p>I have added the above configurations with different Maven profiles in the <em>pom.xml</em>. Check out the <a href="https://github.com/hantsy/jakartaee9-starter-boilerplate/">source codes</a> and explore yourself.</p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=9edce431cadd" width="1" height="1" alt=""><hr><p><a href="https://itnext.io/deploying-jakarta-ee-9-applications-to-glassfish-v6-using-cargo-maven-plugin-9edce431cadd">Deploying Jakarta EE 9 applications to Glassfish v6 using Cargo maven plugin</a> was originally published in <a href="https://itnext.io">ITNEXT</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>
