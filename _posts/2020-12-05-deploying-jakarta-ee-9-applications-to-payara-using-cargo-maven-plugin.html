---
layout: post
title: Deploying Jakarta EE 9 applications to Payara using Cargo maven plugin
---

<p>Payara Community 5.2020.5 has introduced tech preview functionality to run Jakarta EE 9 on Payara Server and Micro, more details please go to the <a href="https://docs.payara.fish/community/docs/5.2020.6/release-notes/release-notes-2020-5.html#_run_jakarta_ee_9_applications_in_tech_preview">release notes</a>.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*XZgar-TMaqJ9r-ovXsLz_A.png" /></figure><p>Originally Payara was a fork of the open-sourced Glassfish, but it includes a bundle of new features that not existed in Glassfish.</p><ul><li>Numerous improvements and quicker bugfixes in comparison to the existing Glassfish</li><li>Java 11(or above) support</li><li>Built-in Microprofile support and ready for cloud native applications</li><li>Many third-party services integration.</li><li>Comprehensive documentation and technical guides</li><li>Commercial support available for paid enterprise users.</li></ul><p>Payara Community is also open sourced, for developers, you use it as an alternative to Glassfish to get better development experience.</p><h3>Prerequisites</h3><p>Make sure you have installed the following software.</p><ul><li>Java 8 or Java 11 (<a href="https://openjdk.java.net/install/">OpenJDK</a> or <a href="https://adoptopenjdk.net/installation.html">AdoptOpenJDK</a>)</li><li><a href="https://www.payara.fish/downloads/payara-platform-community-edition/">Payara Community 5.2020.6</a></li><li><a href="http://maven.apache.org/">Apache Maven</a></li><li>Get to know the basic of <a href="https://codehaus-cargo.github.io/">Cargo maven plugin</a>.</li></ul><h3>Deploy to local Payara server</h3><p>Cargo maven plugin provides a separate <strong>payara</strong> container for Payara server.</p><p>Assume you have downloaded a copy of <a href="https://www.payara.fish/downloads/payara-platform-community-edition/">Payara Community dist</a>, and extracted the files into your local disk.</p><p>Add the following configuration in <em>pom.xml</em> to use the existing Payara domain configuration to run your Jakarta EE 9 applications on the local Payara server.</p><pre>&lt;properties&gt;<br>	&lt;glassfish.home&gt;[ Payara install dir]&lt;/glassfish.home&gt;<br>	&lt;glassfish.domainDir&gt;${glassfish.home}/glassfish/domains&lt;/glassfish.domainDir&gt;<br>	&lt;glassfish.domainName&gt;domain1&lt;/glassfish.domainName&gt;<br>&lt;/properties&gt;<br>&lt;build&gt;<br>	&lt;plugins&gt;<br>		&lt;plugin&gt;<br>			&lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt;<br>			&lt;artifactId&gt;cargo-maven2-plugin&lt;/artifactId&gt;<br>			&lt;configuration&gt;<br>				&lt;container&gt;<br>					&lt;containerId&gt;payara&lt;/containerId&gt;<br>					&lt;type&gt;installed&lt;/type&gt;<br>					&lt;home&gt;${glassfish.home}&lt;/home&gt;<br>				&lt;/container&gt;<br>				&lt;configuration&gt;<br>					&lt;type&gt;existing&lt;/type&gt;<br>					&lt;home&gt;${glassfish.domainDir}&lt;/home&gt;<br>					&lt;properties&gt;<br>						&lt;cargo.glassfish.domain.name&gt;${glassfish.domainName}&lt;/cargo.glassfish.domain.name&gt;<br>						&lt;cargo.remote.password&gt;&lt;/cargo.remote.password&gt;<br>					&lt;/properties&gt;<br>				&lt;/configuration&gt;<br>			&lt;/configuration&gt;<br>		&lt;/plugin&gt;<br>	&lt;/plugins&gt;<br>&lt;/build&gt;</pre><p>The above configuration is almost same as the one we have discussed in <a href="https://github.com/hantsy/jakartaee9-starter-boilerplate/blob/master/docs/docs/deploy-cargo.md">previous Glassfish post</a>, but we used containerId <strong>payara</strong> here.</p><p>Open a terminal, execute the following command to run your application on the Payara server.</p><pre>mvn clean package cargo:run -Ppayara-local</pre><p>The above command will execute a serise of tasks.</p><ul><li>Build the project and package it into a war archive in the <em>target</em> folder</li><li>Starts up Payara server using the existing <em>domain1</em> configuration</li><li>Deploy the packaged war to the running server</li></ul><p>If you want to use a refresh domain configuration every time to run your applications, try to set the configuration type to <strong>standalone</strong>. Change the server <em>configuration</em> section to the following.</p><pre>&lt;configuration&gt;<br>    &lt;type&gt;standalone&lt;/type&gt;<br>    &lt;properties&gt;<br>        &lt;cargo.remote.password&gt;&lt;/cargo.remote.password&gt;<br>    &lt;/properties&gt;<br>&lt;/configuration&gt;</pre><p>A little different from the <strong>existing</strong> configuration, it will create a new domain configuration in the <em>target</em> folder instead of the default <em>domain1</em> in the Payara server.</p><p>In the CI service, such as Github actions, I would like use the official maven-dependency-plugin to prepare a refresh copy of Payara server.</p><pre>&lt;plugin&gt;<br>    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<br>    &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;<br>    &lt;executions&gt;<br>        &lt;execution&gt;<br>            &lt;id&gt;unpack&lt;/id&gt;<br>            &lt;phase&gt;process-resources&lt;/phase&gt;<br>            &lt;goals&gt;<br>                &lt;goal&gt;unpack&lt;/goal&gt;<br>            &lt;/goals&gt;<br>            &lt;configuration&gt;<br>                &lt;artifactItems&gt;<br>                    &lt;artifactItem&gt;<br>                        &lt;groupId&gt;fish.payara.distributions&lt;/groupId&gt;<br>                        &lt;artifactId&gt;payara&lt;/artifactId&gt;<br>                        &lt;version&gt;${payara.version}&lt;/version&gt;<br>                        &lt;type&gt;zip&lt;/type&gt;<br>                        &lt;overWrite&gt;false&lt;/overWrite&gt;<br>                        &lt;outputDirectory&gt;${project.build.directory}&lt;/outputDirectory&gt;<br>                    &lt;/artifactItem&gt;<br>                &lt;/artifactItems&gt;<br>            &lt;/configuration&gt;<br>        &lt;/execution&gt;<br>    &lt;/executions&gt;<br>&lt;/plugin&gt;</pre><p>Change the glassfish.home property to the following.</p><pre>&lt;glassfish.home&gt;${project.build.directory}/payara5&lt;/glassfish.home&gt;</pre><p>To stop the server, just send a CTRL+C to the running console to stop it.</p><h3>Deploy to a running Payara server</h3><p>Use a remote deployer and runtime configuration, you can use Cargo maven plugin to deploy the application to a running Payara, esp. the Payara server is located in a remote server.</p><pre>&lt;plugin&gt;<br>	&lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt;<br>	&lt;artifactId&gt;cargo-maven2-plugin&lt;/artifactId&gt;<br>	&lt;configuration&gt;<br>		&lt;container&gt;<br>			&lt;containerId&gt;payara&lt;/containerId&gt;<br>			&lt;type&gt;remote&lt;/type&gt;<br>		&lt;/container&gt;<br>		&lt;configuration&gt;<br>			&lt;type&gt;runtime&lt;/type&gt;<br>			&lt;properties&gt;<br>				&lt;cargo.remote.username&gt;admin&lt;/cargo.remote.username&gt;<br>				&lt;cargo.remote.password&gt;&lt;/cargo.remote.password&gt;<br>				&lt;cargo.glassfish.admin.port&gt;4848&lt;/cargo.glassfish.admin.port&gt;<br>				&lt;cargo.hostname&gt;localhost&lt;/cargo.hostname&gt;<br>			&lt;/properties&gt;<br>		&lt;/configuration&gt;<br>	&lt;/configuration&gt;<br>	&lt;!-- provides JSR88 client API to deploy on Glassfish/Payara Server --&gt;<br>	&lt;dependencies&gt;<br>		&lt;dependency&gt;<br>			&lt;groupId&gt;org.glassfish.main.deployment&lt;/groupId&gt;<br>			&lt;artifactId&gt;deployment-client&lt;/artifactId&gt;<br>			&lt;version&gt;5.1.0&lt;/version&gt;<br>			&lt;!--&lt;version&gt;${glassfish.version}&lt;/version&gt;--&gt;<br>		&lt;/dependency&gt;<br>	&lt;/dependencies&gt;<br>&lt;/plugin&gt;</pre><p>The above configuration is almost same as the one from <a href="https://github.com/hantsy/jakartaee9-starter-boilerplate/blob/master/docs/docs/deploy-cargo.md">Glassfish doc</a>.</p><p>For a remote server, you can not start and stop the Payara server. Before deploying applications, make sure it is running and accessible from your local environment.</p><p>Use deploy and undeploy goals to perform the deploy and undeploy tasks.</p><pre># deploy applications<br>mvn clean package cargo:deploy -Ppayara-remote</pre><pre># undeploy<br>mvn cargo:undeploy -Ppayara-remote</pre><h3>Verifying the deployed application</h3><p>When the application is deployed successfully, you use curl to verify if the deployed application.</p><pre>curl <a href="http://localhost:8080/jakartaee9-starter-boilerplate/api/greeting/Hantsy">http://localhost:8080/jakartaee9-starter-boilerplate/api/greeting/Hantsy</a><br>{&quot;message&quot;:&quot;Say Hello to Hantsy at 2020-11-14T15:56:10.099&quot;}</pre><blockquote><em>Note: In fact, you can use the </em><em>glassfish5x containerId to deploy Jakarta EE 9 applications to Payara server, and in reverse I think it is also fine when using the </em><em>payara containerId to deploy the application to Glassfish v6.</em></blockquote><p>Grab the <a href="https://github.com/hantsy/jakartaee9-starter-boilerplate/">source codes</a> from my github.</p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=d4fff02091cb" width="1" height="1" alt=""><hr><p><a href="https://itnext.io/deploying-jakarta-ee-9-applications-to-payara-using-cargo-maven-plugin-d4fff02091cb">Deploying Jakarta EE 9 applications to Payara using Cargo maven plugin</a> was originally published in <a href="https://itnext.io">ITNEXT</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>
