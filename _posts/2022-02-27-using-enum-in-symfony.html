---
layout: post
title: Using Enum in Symfony
---

<p>PHP 8.1 introduces the official <em>Enum</em> support. <a href="https://www.doctrine-project.org/2022/01/11/orm-2.11.html">Doctrine brought Enum type support in its ORM framework</a>, and <a href="https://symfony.com/blog/new-in-symfony-5-4-php-enumerations-support">Symfony added serialization and deserialization support of a Enum type</a>.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*zM0-IX7pIVhjXuP1aJtb4w.jpeg" /><figcaption>Photo by <a href="https://unsplash.com/@kakachen?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">te chan</a> on <a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></figcaption></figure><p>It is time to migrate your projects to use PHP Enum if you are using 3rd-party enumeration solutions.</p><p>To use PHP <em>Enum</em>, you have to upgrade to PHP 8.1, and set the PHP version to 8.1 in the project composer file.</p><pre>{<br>    //...<br>    &quot;require&quot;: {<br>        &quot;php&quot;: &quot;&gt;=8.1&quot;,<br>        //...<br>    }<br>}</pre><h3>Creating Enum Class</h3><p>For example, we will add a Status to the Post entity, and defined several fixed values of the post status.</p><pre>&lt;?php</pre><pre>namespace App\Entity;</pre><pre>enum Status: string<br>{<br>    case Draft = &quot;DRAFT&quot;;<br>    case PendingModerated = &quot;PENDING_MODERATED&quot;;<br>    case Published = &quot;PUBLISHED&quot;;<br>}</pre><p>Here we use a <em>string</em> backed enum, add a field in the Post class.</p><pre>#[Column(type: &quot;string&quot;, enumType: Status::class)]<br>private Status $status;</pre><p>Note, set the <em>enumType</em> as the Status class. It will store the status value as a string in the database tables.</p><p>In the Post constructor, assign a default value to the status.</p><pre>public function __construct()<br>{<br>    $this-&gt;status = Status::Draft;<br>    //...<br>}</pre><p>Now everything is ok.</p><h3>Creating HttpMethod</h3><p>When we setup the Route attribute on the Controller class, we use a literal value to set up the HTTP method.</p><pre>#[Route(path: &quot;/{id}&quot;, name: &quot;byId&quot;, methods: [&quot;GET&quot;])]</pre><p>For the <em>methods</em> value, there are only several options available to choose. Obviously, if introducing <em>Enum</em>, it will provide a <em>type-safe</em> way to setup the values and decrease the typo errors.</p><p>Create an Enum named HttpMethod.</p><pre>&lt;?php</pre><pre>namespace App\Annotation;</pre><pre>enum HttpMethod<br>{<br>    case GET;<br>    case POST;<br>    case HEAD;<br>    case OPTIONS;<br>    case PATCH;<br>    case PUT;<br>    case DELETE;<br>}</pre><p>Then refactor the Route attribute and create a series of attributes(Get, Post, Put, Delete, etc.) that are mapped to different HTTP methods.</p><pre>//file : src/Annotation/Get.php<br>#[Attribute]<br>class Get extends Route<br>{<br>    public function getMethods()<br>    {<br>        return [HttpMethod::GET-&gt;name];<br>    }</pre><pre>}</pre><pre>//file : src/Annotation/Head.php<br>#[Attribute]<br>class Head extends Route<br>{<br>    public function getMethods()<br>    {<br>        return [HttpMethod::HEAD-&gt;name];<br>    }</pre><pre>}</pre><pre>//file : src/Annotation/Options.php<br>#[Attribute]<br>class Options extends Route<br>{<br>    public function getMethods()<br>    {<br>        return [HttpMethod::OPTIONS-&gt;name];<br>    }</pre><pre>}</pre><pre>//file : src/Annotation/Patch.php<br>#[Attribute]<br>class Patch extends Route<br>{<br>    public function getMethods()<br>    {<br>        return [HttpMethod::PATCH-&gt;name];<br>    }<br>}</pre><pre>//file : src/Annotation/Post.php<br>#[Attribute]<br>class Post extends Route<br>{<br>    public function getMethods()<br>    {<br>        return [HttpMethod::POST-&gt;name];<br>    }<br>}</pre><pre>//file : src/Annotation/Put.php<br>#[Attribute]<br>class Put extends Route<br>{<br>    public function getMethods()<br>    {<br>        return [HttpMethod::PUT-&gt;name];<br>    }<br>}</pre><pre>//file : src/Annotation/Delete.php<br>#[Attribute]<br>class Delete extends Route<br>{<br>    public function getMethods()<br>    {<br>        return [HttpMethod::DELETE-&gt;name];<br>    }<br>}</pre><p>Now you can polish the PostController, use these attributes instead. As you see, the naming of the new attributes literally look more clear.</p><pre>#[Route(path: &quot;/posts&quot;, name: &quot;posts_&quot;)]<br>class PostController extends AbstractController<br>{</pre><pre>    // constructor...</pre><pre>    // #[Route(path: &quot;&quot;, name: &quot;all&quot;, methods: [&quot;GET&quot;])]<br>    #[Get(path: &quot;&quot;, name: &quot;all&quot;)]<br>    public function all(#[QueryParam] string $keyword,<br>                        #[QueryParam] int $offset = 0,<br>                        #[QueryParam] int $limit = 20): Response<br>    {<br>        //...<br>    }</pre><pre>    // #[Route(path: &quot;/{id}&quot;, name: &quot;byId&quot;, methods: [&quot;GET&quot;])]<br>    #[Get(path: &quot;/{id}&quot;, name: &quot;byId&quot;)]<br>    public function getById(Uuid $id): Response<br>    {<br>       //...<br>    }</pre><pre>    //#[Route(path: &quot;&quot;, name: &quot;create&quot;, methods: [&quot;POST&quot;])]<br>    #[Post(path: &quot;&quot;, name: &quot;create&quot;)]<br>    public function create(#[Body] CreatePostDto $data): Response<br>    {<br>        //...<br>    }</pre><pre>    //#[Route(path: &quot;/{id}&quot;, name: &quot;update&quot;, methods: [&quot;PUT&quot;])]<br>    #[Put(path: &quot;/{id}&quot;, name: &quot;update&quot;)]<br>    public function update(Uuid $id, #[Body] UpdatePostDto $data): Response<br>    {<br>        //...<br>    }</pre><pre>    // #[Route(path: &quot;/{id}/status&quot;, name: &quot;update_status&quot;, methods: [&quot;PUT&quot;])]<br>    #[Put(path: &quot;/{id}/status&quot;, name: &quot;update_status&quot;)]<br>    public function updateStatus(Uuid $id, #[Body] UpdatePostStatusDto $data): Response<br>    {<br>       //...<br>    }</pre><pre>    //#[Route(path: &quot;/{id}&quot;, name: &quot;delete&quot;, methods: [&quot;DELETE&quot;])]<br>    #[Delete(path: &quot;/{id}&quot;, name: &quot;delete&quot;)]<br>    public function deleteById(Uuid $id): Response<br>    {<br>        //...<br>    }</pre><pre>    // comments sub resources.<br>    //#[Route(path: &quot;/{id}/comments&quot;, name: &quot;commentByPostId&quot;, methods: [&quot;GET&quot;])]<br>    #[GET(path: &quot;/{id}/comments&quot;, name: &quot;commentByPostId&quot;)]<br>    public function getComments(Uuid $id): Response<br>    {<br>      //...<br>    }</pre><pre>    //#[Route(path: &quot;/{id}/comments&quot;, name: &quot;addComments&quot;, methods: [&quot;POST&quot;])]<br>    #[Post(path: &quot;/{id}/comments&quot;, name: &quot;addComments&quot;)]<br>    public function addComment(Uuid $id, Request $request): Response<br>    {<br>		//...<br>    }</pre><pre>}</pre><p>Run the application again to make sure it works.</p><h4>Get <a href="https://github.com/hantsy/symfony-rest-sample">the source codes</a> from my Github.</h4><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=8f32d9cfaa0f" width="1" height="1" alt="">
