---
layout: post
title: Deploying Jakarta EE 9 applications to Apache TomEE using Cargo maven plugin
---

<p>In addition to <a href="https://itnext.io/deploying-jakarta-ee-9-applications-to-apache-tomee-e1a9b9399d9b">Deploying Jakarta EE 9 applications to Apache TomEE,</a> in this post using Cargo Maven Plugin instead.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*XZgar-TMaqJ9r-ovXsLz_A.png" /></figure><p>We have discussed the <a href="https://github.com/hantsy/jakartaee9-starter-boilerplate/blob/master/docs/deploy-tomee.md">deployment to Apache TomEE</a> using the official tomee-maven-plugin. With tomee-maven-plugin, it is easy to download a copy of Apache TomEE distribution and start the TomEE server and then deploy the application to it. Or deploy your application to a running TomEE server. The official maven plugin is great for most cases, but it lacks the ability to deploy the application to a local installed server with fine-grained configurations.</p><p>Cargo maven plugin 1.8.3 brought updates to TomEE 9.0 which is aligned to Jakarta EE 9, there are several deployment options.</p><ul><li>Deploy to a local TomEE server with a standalone configuration</li><li>Deploy to a local TomEE server with a existing configuration</li><li>Deploy to a running TomEE server with a runtime configuration</li></ul><h3>Prerequisites</h3><p>Make sure you have installed the following software.</p><ul><li>Java 8 or Java 11 (<a href="https://openjdk.java.net/install/">OpenJDK</a> or <a href="https://adoptopenjdk.net/installation.html">AdoptOpenJDK</a>)</li><li><a href="http://tomee.apache.org/download-ng.html">Apache TomEE (Plume) 9.0.0-M3</a></li><li><a href="http://maven.apache.org/">Apache Maven</a></li><li>Get to know the basic of <a href="https://codehaus-cargo.github.io/">Cargo maven plugin</a>.</li></ul><h3>Deploy to local TomEE server</h3><p>The following configuration is using a local installed server with a <strong>standalone</strong> configuration.</p><pre>&lt;profile&gt;<br>    &lt;id&gt;tomee-local&lt;/id&gt;<br>    &lt;properties&gt;<br>        &lt;tomee.home&gt;${project.build.directory}/apache-tomee-plume-${tomee.version}&lt;/tomee.home&gt;<br>    &lt;/properties&gt;<br>    &lt;build&gt;<br>        &lt;plugins&gt;<br>            &lt;plugin&gt;<br>                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<br>                &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;<br>                &lt;executions&gt;<br>                    &lt;execution&gt;<br>                        &lt;id&gt;unpack&lt;/id&gt;<br>                        &lt;phase&gt;process-resources&lt;/phase&gt;<br>                        &lt;goals&gt;<br>                            &lt;goal&gt;unpack&lt;/goal&gt;<br>                        &lt;/goals&gt;<br>                        &lt;configuration&gt;<br>                            &lt;artifactItems&gt;<br>                                &lt;artifactItem&gt;<br>                                    &lt;groupId&gt;org.apache.tomee.jakarta&lt;/groupId&gt;<br>                                    &lt;artifactId&gt;apache-tomee&lt;/artifactId&gt;<br>                                    &lt;version&gt;${tomee.version}&lt;/version&gt;<br>                                    &lt;classifier&gt;plume&lt;/classifier&gt;<br>                                    &lt;type&gt;zip&lt;/type&gt;<br>                                    &lt;overWrite&gt;false&lt;/overWrite&gt;<br>                                    &lt;outputDirectory&gt;${project.build.directory}&lt;/outputDirectory&gt;<br>                                &lt;/artifactItem&gt;<br>                            &lt;/artifactItems&gt;<br>                        &lt;/configuration&gt;<br>                    &lt;/execution&gt;<br>                &lt;/executions&gt;<br>            &lt;/plugin&gt;<br>            &lt;plugin&gt;<br>                &lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt;<br>                &lt;artifactId&gt;cargo-maven2-plugin&lt;/artifactId&gt;<br>                &lt;configuration&gt;<br>                    &lt;container&gt;<br>                        &lt;containerId&gt;tomee9x&lt;/containerId&gt;<br>                        &lt;type&gt;installed&lt;/type&gt;<br>                        &lt;home&gt;${tomee.home}&lt;/home&gt;<br>                    &lt;/container&gt;<br>                    &lt;configuration&gt;<br>                        &lt;type&gt;standalone&lt;/type&gt;<br>                        &lt;properties&gt;<br>                        &lt;/properties&gt;<br>                    &lt;/configuration&gt;<br>                &lt;/configuration&gt;<br>            &lt;/plugin&gt;<br>        &lt;/plugins&gt;<br>    &lt;/build&gt;<br>&lt;/profile&gt;</pre><p>In this configuration, we use dependency maven plugin to prepare a TomEE server for you, of course you can use the local existing server instead.</p><p>In the container section, used a <strong>installed</strong> type, and specify the <em>home</em> to the <strong>location of the TomEE server</strong>.</p><p>In the configuration section, we use a <strong>standalone</strong> configuration here.</p><blockquote><em>More details about the TomEE properties, see the </em><a href="https://codehaus-cargo.github.io/cargo/TomEE+9.x.html"><em>Cargo TomEE 9.x container page</em></a><em>.</em></blockquote><p>Run the following command to deploy our application.</p><pre>mvn clean package cargo:run -Ptomee-local</pre><p>It will perform a series of tasks, including:</p><ul><li>Build the project and packaged it into a war in the target folder.</li><li>Download a copy of Apache TomEE, and extract the files to the target folder.</li><li>Then create a new <strong>standalone</strong> configuration in the target folder which is only use for this application.</li><li>Start the TomEE server using the created <strong>standalone</strong> configuration.</li><li>Finally deploy the war to the running server.</li></ul><blockquote><em>By default, Apache Tomcat and Apache TomEE do not contain configurations for multi domains/instances, but it is possible, there are lots of articles in </em><a href="https://www.google.com/search?client=firefox-b-d&amp;q=tomcat+multi+instance"><em>Google search results</em></a><em>. The cargo generated </em><strong><em>standalone</em></strong><em> configuration is an example for configuring a new instance.</em></blockquote><p>If you want to reuse the default configuration in the TomEE server, change the configuraiton section to the following.</p><pre>&lt;configuration&gt;<br>    &lt;type&gt;existing&lt;/type&gt;<br>    &lt;home&gt;&lt;/home&gt;<br>&lt;/configuration&gt;</pre><p>In this configuration, set the type value to <strong>existing</strong>, and the <em>home</em> is same as home in the container section, because there is no specifical configurations for domain instances like Glassfish.</p><p>To undeploy the application, just send a CTRL+C to the console.</p><h3>Deploy to a running TomEE server</h3><p>To deploy to a running TomEE server, esp. it is located in a different host, using the following configuration instead.</p><pre>&lt;profile&gt;<br>    &lt;id&gt;tomee-remote&lt;/id&gt;<br>    &lt;!-- Add `manager-script` role to the tomee user in tomee/conf/tomcat-users.xml --&gt;<br>    &lt;!-- Run `mvn clean cargo:deploy -Ptomee-remote` to the running TomEE--&gt;<br>    &lt;build&gt;<br>        &lt;plugins&gt;<br>            &lt;plugin&gt;<br>                &lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt;<br>                &lt;artifactId&gt;cargo-maven2-plugin&lt;/artifactId&gt;<br>                &lt;configuration&gt;<br>                    &lt;container&gt;<br>                        &lt;containerId&gt;tomee9x&lt;/containerId&gt;<br>                        &lt;type&gt;remote&lt;/type&gt;<br>                    &lt;/container&gt;<br>                    &lt;configuration&gt;<br>                        &lt;type&gt;runtime&lt;/type&gt;<br>                        &lt;properties&gt;<br>                            &lt;cargo.remote.username&gt;tomee&lt;/cargo.remote.username&gt;<br>                            &lt;cargo.remote.password&gt;tomee&lt;/cargo.remote.password&gt;<br>                        &lt;/properties&gt;<br>                    &lt;/configuration&gt;<br>                &lt;/configuration&gt;<br>            &lt;/plugin&gt;<br>        &lt;/plugins&gt;<br>    &lt;/build&gt;<br>        &lt;/profile&gt;</pre><p>In this configuration, in the container section, set the type to <strong>remote</strong>, and in the configuration section set type to runtime, and do not forget set username and password used to connect the remote server.</p><p>Similar to Apache Tomcat, Cargo also requires the configured user has a <strong>manager-script</strong> role. Open the <em>tomee dir/conf/tomcat-users.xml</em> file, make sure <strong>manager-script</strong> is set in the roles.</p><pre>&lt;user username=&quot;tomee&quot; password=&quot;tomee&quot; roles=&quot;tomee-admin,manager-gui,manager-script&quot; /&gt;</pre><p>Run the following command to deploy and undeploy the applications.</p><pre># deploy applications<br>mvn clean package cargo:deploy -Ptomee-remote</pre><pre># undeploy<br>mvn cargo:undeploy -Ptomee-remote</pre><p><strong>Grab</strong><a href="https://github.com/hantsy/jakartaee9-starter-boilerplate"><strong> the source codes from my Github</strong></a>.</p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=164644dc9828" width="1" height="1" alt=""><hr><p><a href="https://itnext.io/deploying-jakarta-ee-9-applications-to-apache-tomee-using-cargo-maven-plugin-164644dc9828">Deploying Jakarta EE 9 applications to Apache TomEE using Cargo maven plugin</a> was originally published in <a href="https://itnext.io">ITNEXT</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>
