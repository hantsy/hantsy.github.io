---
layout: post
title: Integrating Auth0 into your Angular applications
---

<p>Auth0 provides SDK for Angular to authenticate users and simply authorize users to access the protected APIs .</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*H0FUZ7BDCiv5AvGDNFS7dw.jpeg" /><figcaption>The image is from <a href="https://unsplash.com/photos/SEYO0Botkgc">https://unsplash.com/photos/SEYO0Botkgc</a></figcaption></figure><p>In this post, we will create a simple Angular SPA application and try to access the <em>Backend API</em> we have created in <a href="https://hantsy.medium.com/secures-rest-apis-with-spring-security-5-and-auth0-41d579ca1e27">the last post</a>.</p><p>Firstly lets create a new application in the Auth0 management console. An application presents an OAuth2 <em>Client</em> role , each client should have a unique client id to identify it.</p><p>In the dashboard UI, expand <em>Applications/applications</em> in the left pane. Click the <em>Create Application</em> button to start up the creating progress.</p><ul><li>In the application name, set a name for this new Angular application, eg. I used <em>spa</em> here.</li><li>Then select the <em>Single page applications</em>.</li><li>Click the <em>Create</em> button.</li></ul><p>After it is created, open the <em>Settings</em> page, you will find a <em>Client ID</em> and <em>Client Secrets</em> are generated in the page. In the <em>Application URLs</em> section, add <a href="http://localhost:4200"><em>http://localhost:4200</em></a> to the following fields.</p><ul><li><em>Allowed Callback URLs</em></li><li><em>Allowed Logout URLs</em></li><li><em>Allowed Web Origins</em></li><li><em>Allowed Origins (CORS)</em></li></ul><p>In the <em>Quickstarts</em> tab, Auth0 provides a series of tutorials to integrate Auth0 with the popular SPA framework, including Angular/React/Vue, etc.</p><p>I followed the official Angular Quickstart tutorial, but I refactored the project file structure according to the <a href="https://angular.io/guide/styleguide">Angular Coding Style Guide</a>, and ported the existing codes from <a href="https://github.com/hantsy/angular-spring-reactive-sample">hantsy/angular-spring-reactive-sample</a> to simplify the development work. The final source codes can be found under my Github account.</p><blockquote><em>More details about creating this sample application step by step, please read the </em><a href="https://auth0.com/docs/quickstart/spa/angular"><em>official Angular Quickstart tutorial</em></a><em>.</em></blockquote><blockquote><em>For the implementation details of accessing Backend APIs, check </em><a href="https://hantsy.medium.com/build-a-reactive-application-with-spring-boot-2-0-and-angular-de0ee5837fed"><em>this article I have published on Medium</em></a><em> and this old </em><a href="https://github.com/hantsy/angular2-sample"><em>Angular2 sample codes</em></a><em>.</em></blockquote><p>Here we are going to introduce the details of integrating Auth0 Angular SDK.</p><p>Install Auth0 Angular SDK.</p><pre>$ npm i @auth0/auth0-angular</pre><p>Auth0 Angular SDK provides a series of authentication related facilities out of box, including AuthModule, AuthService , AuthGuard and AuthHttpInterceptor . We have built those components from scratch in the <a href="https://github.com/hantsy/angular-spring-reactive-sample">hantsy/angular-spring-reactive-sample</a>.</p><p>Configure AuthModule and AuthHttpInterceptor in the <em>app.module.ts</em>.</p><pre>// Import the module from the SDK<br>import { AuthHttpInterceptor, AuthModule } from &#39;@auth0/auth0-angular&#39;;</pre><pre>@NgModule({<br>  declarations: [AppComponent],<br>  imports: [<br>    BrowserModule,<br>    BrowserAnimationsModule,<br>    CoreModule,<br>    SharedModule,<br>    // Import the module into the application, with configuration<br>    AuthModule.forRoot({<br>      domain: &#39;dev-ese8241b.us.auth0.com&#39;,<br>      clientId: &#39;xwulkQN219vK2LU9MKowCo0HQLRi0WQU&#39;,<br>      audience: &#39;https://hantsy.github.io/api&#39;,<br>      scope: &#39;openid profile email read:posts write:posts delete:posts&#39;,<br>      // The AuthHttpInterceptor configuration<br>      httpInterceptor: {<br>        allowedList: [<br>          &#39;/api/*&#39;,<br>        ],<br>      },<br>    }),<br>    HomeModule,<br>    AppRoutingModule,<br>  ],<br>  providers: [<br>    {<br>      provide: HTTP_INTERCEPTORS,<br>      useClass: AuthHttpInterceptor,<br>      multi: true,<br>    },<br>  ],<br>  bootstrap: [AppComponent],<br>})<br>export class AppModule {}</pre><p>Let’s have a look at the content of AppRoutingModule. In the path of profile module and admin module, add a AuthGuard to ensure the current user is authenticated.</p><pre>import { AuthGuard } from &#39;@auth0/auth0-angular&#39;;<br>//...</pre><pre>const routes: Routes = [<br>  { path: &#39;&#39;, redirectTo: &#39;/home&#39;, pathMatch: &#39;full&#39; },<br>  {<br>    path: &#39;profile&#39;,<br>    loadChildren: () =&gt;<br>      import(&#39;./profile/profile.module&#39;).then((m) =&gt; m.ProfileModule),<br>    canActivate: [AuthGuard],<br>  },<br>  {<br>    path: &#39;posts&#39;,<br>    loadChildren: () =&gt;<br>      import(&#39;./posts/posts.module&#39;).then((m) =&gt; m.PostsModule),<br>  },<br>  {<br>    path: &#39;admin&#39;,<br>    loadChildren: () =&gt;<br>      import(&#39;./admin/admin.module&#39;).then((m) =&gt; m.AdminModule),<br>    canActivate: [AuthGuard],<br>  },<br>  //{ path: &#39;**&#39;, component:PageNotFoundComponent}<br>];</pre><pre>@NgModule({<br>  imports: [RouterModule.forRoot(routes)],<br>  exports: [RouterModule],<br>})<br>export class AppRoutingModule {}</pre><p>To show/hide the login and log out button, inject an AuthService and detect the authentication status via its isAuthenticated method.</p><pre>export class AuthenticationButtonComponent implements OnInit {<br>  constructor(public auth: AuthService) {}</pre><pre>  ngOnInit(): void {}<br>}</pre><p>The template file of AuthenticationButtonComponent.</p><pre>&lt;app-login-button *ngIf=&quot;(auth.isAuthenticated$ | async) === false&quot;&gt;<br>&lt;/app-login-button&gt;</pre><pre>&lt;app-logout-button *ngIf=&quot;auth.isAuthenticated$ | async&quot;&gt;<br>&lt;/app-logout-button&gt;</pre><p>To test the application, we have to add some testing users in Auth0(you can also use <em>Signup</em> form to register a user).</p><p>Go to Auth0 management console. Expand the <em>Authentication/Databases</em> in the left pane, we will use the default <em>Username-Password-Authentication</em> here, click the options button to open <em>Settings</em> page, make sure <em>Requires Username</em> is checked, I would like to use a username instead of email to login. Switch to <em>Password Policy</em> tab, make <em>Password strength</em> lower, it allows you to create simple passwords for your testing users. Switch to the <em>Applications</em> tab, make sure your application is activated there.</p><p>Let’s add some users now. Open <em>User management/Users</em> in the dashboard. Click <em>Create User</em> to start adding new users. Add the following new users(username/password/email), and assign permissions to them.</p><ul><li>user/password/user@example.com — read:posts, write:posts</li><li>admin/password/admin@example.com — read:posts, write:posts, delete:posts</li></ul><p>Go to the user details page of every users, under the email, mark the email as verified directly to avoid email verification.</p><p>Now back to your application, run the following command to start it.</p><pre>$ npm run start</pre><p>Click login button to show the Auth0 Login Form, input the user/password to login.</p><p>Navigate to the <em>Profile</em> page, you will see the screen similar to the following.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/0*WLh-8P7h-HcGfPof.png" /></figure><p>The blog accesses the <em>Backend API</em> we have created. To experience it, make sure the Backend API is running.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/0*bQVaA3xTTeGNAZWi.png" /></figure><p>Try to log out, it should return to the <a href="http://localhost:4200"><em>http://localhost:4200</em></a>.</p><h4>Grab the source codes form my <a href="https://github.com/hantsy/spring-security-auth0-sample/tree/master/ui">Github</a>.</h4><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=42fabef31f3e" width="1" height="1" alt=""><hr><p><a href="https://itnext.io/integrating-auth0-into-your-angular-applications-42fabef31f3e">Integrating Auth0 into your Angular applications</a> was originally published in <a href="https://itnext.io">ITNEXT</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>
